-----------------------------------------------------------
Output from Shell Script:
Job ID: 10634275
Job User: jasonjia
Num Cores: 1
Array(Task ID): 25 of 64
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: openpyxl in /home/jasonjia/.local/lib/python3.8/site-packages (3.1.2)
Requirement already satisfied: et-xmlfile in /home/jasonjia/.local/lib/python3.8/site-packages (from openpyxl) (1.1.0)

[notice] A new release of pip is available: 23.0.1 -> 23.1.2
[notice] To update, run: pip install --upgrade pip
Program Path: filter_boardex_by_columns_and_rows.py
Filepath of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_010523.xlsx
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Input Folder: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex
Output Folder: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows
-----------------------------------------------------------
Output from Python Script:
This is array 25 / 64
Filepath of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_010523.xlsx
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Input Folder (containing raw BoardEx .xlsx files): /project/kh_mercury_1/manager_and_board_characteristics/data/boardex
Output Folder (after we filter by both columns and rows): /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows
Total number of files in input folder: 3246
This process will cover file(s): 1201 to 1250
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 993.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498210, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498210, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (27207, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 993.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 939.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497562, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497562, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (23391, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 939.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 921.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499694, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499694, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (64653, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 921.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 950.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499856, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499856, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (18730, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 950.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 916.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499541, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499541, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (48223, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 916.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 948.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496666, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496666, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (36097, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 948.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 998.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499177, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499177, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (23584, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 998.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 912.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498493, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498493, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (79748, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 912.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 936.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499486, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499486, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (71537, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 936.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 959.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499880, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499880, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (20710, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 959.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 910.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496497, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496497, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (79028, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 910.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 978.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499596, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499596, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (20944, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 978.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 995.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499173, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499173, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (20335, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 995.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 899.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497956, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497956, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (43878, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 899.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 996.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499716, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499716, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (49031, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 996.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 943.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499184, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499184, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (19106, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 943.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 907.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496701, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496701, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (67201, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 907.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 960.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498286, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498286, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (27798, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 960.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 966.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497958, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497958, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (64630, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 966.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 973.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498545, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498545, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (40403, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 973.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 915.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499764, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499764, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (25971, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 915.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 952.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496600, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496600, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (51759, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 952.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 951.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499897, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499897, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (21551, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 951.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 986.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498353, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498353, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (30469, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 986.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 968.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (10548, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (10548, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (0, 22)
Note: df has no rows and/or columns!
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 931.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497488, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497488, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (47598, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 931.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 958.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498851, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498851, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (23387, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 958.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 90.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (495361, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (495361, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (66644, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 90.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 903.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499950, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499950, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (44701, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 903.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 979.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (12443, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (12443, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1861, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 979.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 901.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497886, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497886, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (18814, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 901.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 914.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499567, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499567, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (77254, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 914.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 97.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499545, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499545, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (37512, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 97.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 98.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499564, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499564, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (52815, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 98.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 997.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497818, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497818, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (27497, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 997.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 911.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499688, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499688, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (109520, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 911.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 920.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498311, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498311, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (27001, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 920.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 970.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499496, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499496, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (25480, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 970.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 925.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499470, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499470, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (88287, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 925.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 972.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499680, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499680, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (53285, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 972.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 969.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497568, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497568, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (23715, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 969.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 93.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499866, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499866, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (51347, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 93.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 991.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499865, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499865, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (4530, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 991.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 987.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499933, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499933, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (18779, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 987.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 908.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499530, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499530, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (53399, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 908.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 91.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498123, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498123, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (72711, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 91.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 904.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499016, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499016, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (12855, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 904.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 96.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498042, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498042, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (61448, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 96.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 992.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498029, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498029, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (17544, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 992.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 945.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496894, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496894, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (30457, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 945.xlsx
Done!
/home/jasonjia/.local/lib/python3.8/site-packages/openpyxl/worksheet/_reader.py:329: UserWarning: Conditional Formatting extension is not supported and will be removed
  warn(msg)
-----------------------------------------------------------
List of files kept: ['NA - SMDEs Network - 993.xlsx', 'NA - SMDEs Network - 939.xlsx', 'NA - SMDEs Network - 921.xlsx', 'NA - SMDEs Network - 950.xlsx', 'NA - SMDEs Network - 916.xlsx', 'NA - SMDEs Network - 948.xlsx', 'NA - SMDEs Network - 998.xlsx', 'NA - SMDEs Network - 912.xlsx', 'NA - SMDEs Network - 936.xlsx', 'NA - SMDEs Network - 959.xlsx', 'NA - SMDEs Network - 910.xlsx', 'NA - SMDEs Network - 978.xlsx', 'NA - SMDEs Network - 995.xlsx', 'NA - SMDEs Network - 899.xlsx', 'NA - SMDEs Network - 996.xlsx', 'NA - SMDEs Network - 943.xlsx', 'NA - SMDEs Network - 907.xlsx', 'NA - SMDEs Network - 960.xlsx', 'NA - SMDEs Network - 966.xlsx', 'NA - SMDEs Network - 973.xlsx', 'NA - SMDEs Network - 915.xlsx', 'NA - SMDEs Network - 952.xlsx', 'NA - SMDEs Network - 951.xlsx', 'NA - SMDEs Network - 986.xlsx', 'NA - SMDEs Network - 968.xlsx', 'NA - SMDEs Network - 931.xlsx', 'NA - SMDEs Network - 958.xlsx', 'NA - SMDEs Network - 90.xlsx', 'NA - SMDEs Network - 903.xlsx', 'NA - SMDEs Network - 979.xlsx', 'NA - SMDEs Network - 901.xlsx', 'NA - SMDEs Network - 914.xlsx', 'NA - SMDEs Network - 97.xlsx', 'NA - SMDEs Network - 98.xlsx', 'NA - SMDEs Network - 997.xlsx', 'NA - SMDEs Network - 911.xlsx', 'NA - SMDEs Network - 920.xlsx', 'NA - SMDEs Network - 970.xlsx', 'NA - SMDEs Network - 925.xlsx', 'NA - SMDEs Network - 972.xlsx', 'NA - SMDEs Network - 969.xlsx', 'NA - SMDEs Network - 93.xlsx', 'NA - SMDEs Network - 991.xlsx', 'NA - SMDEs Network - 987.xlsx', 'NA - SMDEs Network - 908.xlsx', 'NA - SMDEs Network - 91.xlsx', 'NA - SMDEs Network - 904.xlsx', 'NA - SMDEs Network - 96.xlsx', 'NA - SMDEs Network - 992.xlsx', 'NA - SMDEs Network - 945.xlsx']
------
List of files not kept: []
Done!
