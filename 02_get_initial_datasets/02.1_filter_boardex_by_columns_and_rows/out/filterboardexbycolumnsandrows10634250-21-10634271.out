-----------------------------------------------------------
Output from Shell Script:
Job ID: 10634271
Job User: jasonjia
Num Cores: 1
Array(Task ID): 21 of 64
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: openpyxl in /home/jasonjia/.local/lib/python3.8/site-packages (3.1.2)
Requirement already satisfied: et-xmlfile in /home/jasonjia/.local/lib/python3.8/site-packages (from openpyxl) (1.1.0)

[notice] A new release of pip is available: 23.0.1 -> 23.1.2
[notice] To update, run: pip install --upgrade pip
Program Path: filter_boardex_by_columns_and_rows.py
Filepath of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_010523.xlsx
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Input Folder: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex
Output Folder: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows
-----------------------------------------------------------
Output from Python Script:
This is array 21 / 64
Filepath of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_010523.xlsx
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Input Folder (containing raw BoardEx .xlsx files): /project/kh_mercury_1/manager_and_board_characteristics/data/boardex
Output Folder (after we filter by both columns and rows): /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows
Total number of files in input folder: 3246
This process will cover file(s): 1001 to 1050
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1307.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497079, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497079, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (72074, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1307.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1279.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498877, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498877, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (50084, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1279.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1282.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499711, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499711, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (38536, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1282.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1246.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498371, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498371, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (85598, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1246.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1318.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499248, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499248, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (94936, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1318.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 126.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498258, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498258, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (120773, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 126.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1261.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499338, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499338, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (42641, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1261.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1255.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497758, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497758, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (43832, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1255.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1320.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (12431, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (12431, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (0, 22)
Note: df has no rows and/or columns!
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1275.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496713, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496713, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (52484, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1275.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1284.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499920, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499920, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (41176, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1284.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1314.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496344, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496344, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (67527, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1314.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1323.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499891, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499891, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (55543, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1323.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1274.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499969, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499969, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (46395, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1274.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1326.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499096, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499096, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (113834, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1326.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1301.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499677, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499677, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (31805, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1301.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1303.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498459, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498459, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (62892, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1303.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1305.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499452, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499452, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (37125, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1305.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1270.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499890, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499890, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (29054, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1270.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1262.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498282, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498282, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (39522, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1262.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1254.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (12604, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (12604, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1031, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1254.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 131.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498789, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498789, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (92151, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 131.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1298.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (11496, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (11496, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (264, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1298.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1295.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498803, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498803, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (15610, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1295.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1278.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499444, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499444, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (60736, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1278.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1292.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498768, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498768, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (65612, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1292.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1276.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (14010, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (14010, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (3740, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1276.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 132.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (11565, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (11565, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1436, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 132.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1328.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496607, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496607, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (83345, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1328.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1249.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498424, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498424, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (59293, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1249.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1277.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498286, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498286, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (43706, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1277.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1290.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499475, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499475, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (34563, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1290.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1316.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497536, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497536, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (73909, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1316.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1299.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497979, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497979, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (11940, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1299.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1332.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498643, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498643, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (69696, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1332.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1287.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (8537, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (8537, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (0, 22)
Note: df has no rows and/or columns!
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1247.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497450, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497450, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (74371, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1247.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1294.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496311, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496311, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (89485, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1294.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1302.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499902, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499902, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (52492, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1302.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1257.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496952, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496952, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (37026, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1257.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1317.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499556, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499556, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (82922, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1317.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 125.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496010, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496010, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (145009, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 125.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1311.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499543, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499543, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (98777, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1311.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1325.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498856, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498856, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (81556, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1325.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1258.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498178, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498178, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (39276, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1258.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1309.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (11029, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (11029, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (0, 22)
Note: df has no rows and/or columns!
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1321.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499825, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499825, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (47969, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1321.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 129.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499901, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499901, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (86894, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 129.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1281.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499140, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499140, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (55545, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1281.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Network - 1271.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498456, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498456, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (49976, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Network - 1271.xlsx
Done!
-----------------------------------------------------------
/home/jasonjia/.local/lib/python3.8/site-packages/openpyxl/worksheet/_reader.py:329: UserWarning: Conditional Formatting extension is not supported and will be removed
  warn(msg)
List of files kept: ['NA - SMDEs Network - 1307.xlsx', 'NA - SMDEs Network - 1279.xlsx', 'NA - SMDEs Network - 1282.xlsx', 'NA - SMDEs Network - 1246.xlsx', 'NA - SMDEs Network - 1318.xlsx', 'NA - SMDEs Network - 126.xlsx', 'NA - SMDEs Network - 1261.xlsx', 'NA - SMDEs Network - 1255.xlsx', 'NA - SMDEs Network - 1320.xlsx', 'NA - SMDEs Network - 1275.xlsx', 'NA - SMDEs Network - 1284.xlsx', 'NA - SMDEs Network - 1314.xlsx', 'NA - SMDEs Network - 1323.xlsx', 'NA - SMDEs Network - 1274.xlsx', 'NA - SMDEs Network - 1326.xlsx', 'NA - SMDEs Network - 1301.xlsx', 'NA - SMDEs Network - 1303.xlsx', 'NA - SMDEs Network - 1305.xlsx', 'NA - SMDEs Network - 1270.xlsx', 'NA - SMDEs Network - 1262.xlsx', 'NA - SMDEs Network - 1254.xlsx', 'NA - SMDEs Network - 131.xlsx', 'NA - SMDEs Network - 1298.xlsx', 'NA - SMDEs Network - 1295.xlsx', 'NA - SMDEs Network - 1278.xlsx', 'NA - SMDEs Network - 1292.xlsx', 'NA - SMDEs Network - 1276.xlsx', 'NA - SMDEs Network - 132.xlsx', 'NA - SMDEs Network - 1328.xlsx', 'NA - SMDEs Network - 1249.xlsx', 'NA - SMDEs Network - 1277.xlsx', 'NA - SMDEs Network - 1290.xlsx', 'NA - SMDEs Network - 1316.xlsx', 'NA - SMDEs Network - 1299.xlsx', 'NA - SMDEs Network - 1332.xlsx', 'NA - SMDEs Network - 1287.xlsx', 'NA - SMDEs Network - 1247.xlsx', 'NA - SMDEs Network - 1294.xlsx', 'NA - SMDEs Network - 1302.xlsx', 'NA - SMDEs Network - 1257.xlsx', 'NA - SMDEs Network - 1317.xlsx', 'NA - SMDEs Network - 125.xlsx', 'NA - SMDEs Network - 1311.xlsx', 'NA - SMDEs Network - 1325.xlsx', 'NA - SMDEs Network - 1258.xlsx', 'NA - SMDEs Network - 1309.xlsx', 'NA - SMDEs Network - 1321.xlsx', 'NA - SMDEs Network - 129.xlsx', 'NA - SMDEs Network - 1281.xlsx', 'NA - SMDEs Network - 1271.xlsx']
------
List of files not kept: []
Done!
