-----------------------------------------------------------
Output from Shell Script:
Job ID: 10634255
Job User: jasonjia
Num Cores: 1
Array(Task ID): 5 of 64
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: openpyxl in /home/jasonjia/.local/lib/python3.8/site-packages (3.1.2)
Requirement already satisfied: et-xmlfile in /home/jasonjia/.local/lib/python3.8/site-packages (from openpyxl) (1.1.0)

[notice] A new release of pip is available: 23.0.1 -> 23.1.2
[notice] To update, run: pip install --upgrade pip
Program Path: filter_boardex_by_columns_and_rows.py
Filepath of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_010523.xlsx
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Input Folder: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex
Output Folder: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows
-----------------------------------------------------------
Output from Python Script:
This is array 5 / 64
Filepath of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_010523.xlsx
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Input Folder (containing raw BoardEx .xlsx files): /project/kh_mercury_1/manager_and_board_characteristics/data/boardex
Output Folder (after we filter by both columns and rows): /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows
Total number of files in input folder: 3246
This process will cover file(s): 201 to 250
-----------------------------------------------------------
File name (kept): NA - Director Network - 307.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (14109, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (14109, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (339, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 307.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 316.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499984, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499984, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (39789, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 316.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 338.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499487, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499487, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (13834, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 338.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 315.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496295, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496295, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (56340, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 315.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 349.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497891, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497891, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (19663, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 349.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 282.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498340, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498340, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (53374, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 282.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 365.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498546, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498546, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (37395, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 365.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 306.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499214, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499214, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (52311, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 306.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 341.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497311, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497311, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (42884, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 341.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 291.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499580, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499580, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (58277, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 291.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 326.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499319, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499319, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (47576, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 326.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 319.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496904, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496904, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (50369, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 319.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 362.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (10067, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (10067, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (96, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 362.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 325.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499896, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499896, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (63553, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 325.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 327.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499343, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499343, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (49247, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 327.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 343.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498178, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498178, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (63783, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 343.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 344.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499601, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499601, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (10154, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 344.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 299.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498256, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498256, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (52461, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 299.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 335.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499206, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499206, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (43640, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 335.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 334.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499938, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499938, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (48044, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 334.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 3.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497107, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497107, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (116589, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 3.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 294.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496888, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496888, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (38830, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 294.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 320.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499386, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499386, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (46978, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 320.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 298.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (494754, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (494754, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (53792, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 298.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 283.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498744, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498744, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (57551, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 283.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 364.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498857, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498857, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (28778, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 364.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 356.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498696, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498696, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (30300, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 356.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 295.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499935, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499935, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (61719, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 295.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 285.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (3867, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (3867, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (2963, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 285.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 336.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497271, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497271, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (42836, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 336.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 284.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499906, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499906, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (63552, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 284.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 354.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499933, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499933, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (37754, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 354.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 33.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (10957, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (10957, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (2049, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 33.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 366.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497228, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497228, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (40372, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 366.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 300.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498975, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498975, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (55397, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 300.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 329.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (11245, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (11245, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (908, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 329.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 302.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499997, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499997, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (39083, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 302.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 296.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (11099, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (11099, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (0, 22)
Note: df has no rows and/or columns!
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 358.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498411, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498411, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (33608, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 358.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 313.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498058, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498058, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (30834, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 313.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 361.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498311, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498311, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (51330, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 361.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 323.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498414, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498414, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (66853, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 323.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 321.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497789, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497789, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (32030, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 321.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 280.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499817, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499817, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (59861, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 280.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 309.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499900, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499900, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (64005, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 309.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 281.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497773, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497773, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (41393, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 281.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 303.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498072, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498072, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (64683, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 303.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 328.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498432, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498432, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (50340, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 328.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 30.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (495546, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (495546, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (143913, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 30.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Network - 353.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498211, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
/home/jasonjia/.local/lib/python3.8/site-packages/openpyxl/worksheet/_reader.py:329: UserWarning: Conditional Formatting extension is not supported and will be removed
  warn(msg)
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498211, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (38644, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Network - 353.xlsx
Done!
-----------------------------------------------------------
List of files kept: ['NA - Director Network - 307.xlsx', 'NA - Director Network - 316.xlsx', 'NA - Director Network - 338.xlsx', 'NA - Director Network - 315.xlsx', 'NA - Director Network - 349.xlsx', 'NA - Director Network - 282.xlsx', 'NA - Director Network - 365.xlsx', 'NA - Director Network - 306.xlsx', 'NA - Director Network - 341.xlsx', 'NA - Director Network - 291.xlsx', 'NA - Director Network - 326.xlsx', 'NA - Director Network - 319.xlsx', 'NA - Director Network - 362.xlsx', 'NA - Director Network - 325.xlsx', 'NA - Director Network - 327.xlsx', 'NA - Director Network - 343.xlsx', 'NA - Director Network - 344.xlsx', 'NA - Director Network - 299.xlsx', 'NA - Director Network - 335.xlsx', 'NA - Director Network - 334.xlsx', 'NA - Director Network - 3.xlsx', 'NA - Director Network - 294.xlsx', 'NA - Director Network - 320.xlsx', 'NA - Director Network - 298.xlsx', 'NA - Director Network - 283.xlsx', 'NA - Director Network - 364.xlsx', 'NA - Director Network - 356.xlsx', 'NA - Director Network - 295.xlsx', 'NA - Director Network - 285.xlsx', 'NA - Director Network - 336.xlsx', 'NA - Director Network - 284.xlsx', 'NA - Director Network - 354.xlsx', 'NA - Director Network - 33.xlsx', 'NA - Director Network - 366.xlsx', 'NA - Director Network - 300.xlsx', 'NA - Director Network - 329.xlsx', 'NA - Director Network - 302.xlsx', 'NA - Director Network - 296.xlsx', 'NA - Director Network - 358.xlsx', 'NA - Director Network - 313.xlsx', 'NA - Director Network - 361.xlsx', 'NA - Director Network - 323.xlsx', 'NA - Director Network - 321.xlsx', 'NA - Director Network - 280.xlsx', 'NA - Director Network - 309.xlsx', 'NA - Director Network - 281.xlsx', 'NA - Director Network - 303.xlsx', 'NA - Director Network - 328.xlsx', 'NA - Director Network - 30.xlsx', 'NA - Director Network - 353.xlsx']
------
List of files not kept: []
Done!
