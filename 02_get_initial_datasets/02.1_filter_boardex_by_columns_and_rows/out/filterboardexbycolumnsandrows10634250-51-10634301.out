-----------------------------------------------------------
Output from Shell Script:
Job ID: 10634301
Job User: jasonjia
Num Cores: 1
Array(Task ID): 51 of 64
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: openpyxl in /home/jasonjia/.local/lib/python3.8/site-packages (3.1.2)
Requirement already satisfied: et-xmlfile in /home/jasonjia/.local/lib/python3.8/site-packages (from openpyxl) (1.1.0)

[notice] A new release of pip is available: 23.0.1 -> 23.1.2
[notice] To update, run: pip install --upgrade pip
Program Path: filter_boardex_by_columns_and_rows.py
Filepath of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_010523.xlsx
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Input Folder: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex
Output Folder: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows
-----------------------------------------------------------
Output from Python Script:
This is array 51 / 64
Filepath of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_010523.xlsx
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Input Folder (containing raw BoardEx .xlsx files): /project/kh_mercury_1/manager_and_board_characteristics/data/boardex
Output Folder (after we filter by both columns and rows): /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows
Total number of files in input folder: 3246
This process will cover file(s): 2501 to 2550
-----------------------------------------------------------
File name (kept): NA - SMDEs Profile - Employment Historical Board.xlsx
Unique workbook name: SMDEs Profile - Employment Historical Board
List of sheets to open: ['Historic Board Role']
------
Sheet 0 : Historic Board Role
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (358430, 17)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED', 'Start Date',
       'End Date', 'Committee Name', 'Committee Role'],
      dtype='object')
List of cols to keep (after processing): ['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name', 'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name', 'Company Type', 'Role', 'Role Description']
df.shape: (358430, 12)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (53166, 12)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Profile - Employment Historical Board.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Details Mapping File.xlsx
Unique workbook name: Director Details Mapping File
List of sheets to open: ['Sheet1']
------
Sheet 0 : Sheet1
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (135706, 3)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Bex Dir ID', 'DirectorID*', 'Director Name'], dtype='object')
List of cols to keep (after processing): ['Bex Dir ID', 'DirectorID*', 'Director Name']
df.shape: (135706, 3)
Done!
---
Filtering df by rows:
---
No column found that contains 'companyid', not filtering by rows.
df.shape: (135706, 3)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Details Mapping File.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Profile - Employment Current Board.xlsx
Unique workbook name: SMDEs Profile - Employment Current Board
List of sheets to open: ['Current Board Role']
------
Sheet 0 : Current Board Role
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (112947, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED', 'Start Date',
       'Committee Name', 'Committee Role'],
      dtype='object')
List of cols to keep (after processing): ['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name', 'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name', 'Company Type', 'Role', 'Role Description', 'ED/NED', 'Start Date', 'Committee Name', 'Committee Role']
df.shape: (112947, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (14269, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Profile - Employment Current Board.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Org Summary - 2.xlsx
Unique workbook name: SMDEs Org Summary
List of sheets to open: ['Board Summary']
------
Sheet 0 : Board Summary
% NaNs in first row: 83.6 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499965, 61)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Country', 'CompanyID*', 'Company Name', 'ISIN',
       'Ticker', 'Index', 'Sector', 'Director Type', 'DirectorID*',
       'Individual Name', 'Characteristics of Roles - Individual Role',
       'Characteristics of Roles - Director Network Size',
       'Characteristics of Roles - Time to Retirement',
       'Characteristics of Roles - Time in Role',
       'Characteristics of Roles - Time on Board',
       'Characteristics of Roles - Time in Company',
       'Director Experience - Total Number of Quoted Boards to Date',
       'Director Experience - Total Number of Private Boards to Date',
       'Director Experience - Total Number of Other Boards to Date',
       'Director Experience - Total Number of Quoted Current Boards',
       'Director Experience - Total Number of Private Current Boards',
       'Director Experience - Total Number of Other Current Boards',
       'Director Experience - Avg. Yrs on Other Quoted Boards',
       'Director Experience - Age (Yrs)',
       'Director Experience - Number of Qualifications',
       'Director Experience - Gender', 'Director Experience - Nationality Mix',
       'Ratios - Bonus/ (Bonus&Salary)', 'Ratios - Equity Linked/ Total',
       'Ratios - Performance/ Total', 'Ratios - %Change from Last Period',
       'Ratios - Wealth Delta', 'Annual Direct Compensation - Salary',
       'Annual Direct Compensation - Bonus',
       'Annual Direct Compensation - D.C Pension',
       'Annual Direct Compensation - Other',
       'Annual Direct Compensation - Total Salary+Bonus',
       'Annual Direct Compensation - Total Inc. D.C. Pension & Other',
       'Annual- Equity Linked Options - Shares',
       'Annual- Equity Linked Options - LTIPS(max)',
       'Annual- Equity Linked Options - Vesting Date',
       'Annual- Equity Linked Options - Intrinsic Options (excercisable)',
       'Annual- Equity Linked Options - Intrinsic Options (unexercisable)',
       'Annual- Equity Linked Options - Estimated Options (exercisable)',
       'Annual- Equity Linked Options - Estimated Options (unexcercisable)',
       'Annual- Equity Linked Options - Share Price',
       'Annual- Equity Linked Options - Total Equity Linked Compensation',
       'Total - Total Annual Compensation', 'Accumulated Wealth - Shares',
       'Accumulated Wealth - LTIPS(max)',
       'Accumulated Wealth - Intrinsic Option',
       'Accumulated Wealth - Estimated Option',
       'Accumulated Wealth - Liquid Wealth', 'Total Wealth - Total Wealth',
       'Committee Members - AUDIT COMMITTEE MEMBER (if yes then put M)',
       'Committee Members - REMUNERATION/ COMPENSATION COMMITTEE MEMBER',
       'Committee Members - NOMINATION COMMITTEE MEMBER',
       'Committee Size - AUDIT COMMITTEE SIZE',
       'Committee Size - REMUNERATION/ COMPENSATION COMMITTEE SIZE',
       'Committee Size - NOMINATION COMMITTEE SIZE'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Country', 'CompanyID*', 'Company Name', 'ISIN', 'Ticker', 'Index', 'Sector', 'Director Type', 'DirectorID*', 'Individual Name', 'Characteristics of Roles - Individual Role', 'Characteristics of Roles - Director Network Size', 'Characteristics of Roles - Time to Retirement', 'Characteristics of Roles - Time in Role', 'Characteristics of Roles - Time on Board', 'Characteristics of Roles - Time in Company', 'Director Experience - Total Number of Quoted Boards to Date', 'Director Experience - Total Number of Private Boards to Date', 'Director Experience - Total Number of Other Boards to Date', 'Director Experience - Total Number of Quoted Current Boards', 'Director Experience - Total Number of Private Current Boards', 'Director Experience - Total Number of Other Current Boards', 'Director Experience - Avg. Yrs on Other Quoted Boards', 'Director Experience - Age (Yrs)', 'Director Experience - Number of Qualifications', 'Director Experience - Gender', 'Director Experience - Nationality Mix', 'Ratios - Bonus/ (Bonus&Salary)', 'Ratios - Equity Linked/ Total', 'Ratios - Performance/ Total', 'Ratios - %Change from Last Period', 'Ratios - Wealth Delta', 'Annual Direct Compensation - Salary', 'Annual Direct Compensation - Bonus', 'Annual Direct Compensation - D.C Pension', 'Annual Direct Compensation - Other', 'Annual Direct Compensation - Total Salary+Bonus', 'Annual Direct Compensation - Total Inc. D.C. Pension & Other', 'Annual- Equity Linked Options - Shares', 'Annual- Equity Linked Options - LTIPS(max)', 'Annual- Equity Linked Options - Vesting Date', 'Annual- Equity Linked Options - Intrinsic Options (excercisable)', 'Annual- Equity Linked Options - Intrinsic Options (unexercisable)', 'Annual- Equity Linked Options - Estimated Options (exercisable)', 'Annual- Equity Linked Options - Estimated Options (unexcercisable)', 'Annual- Equity Linked Options - Share Price', 'Annual- Equity Linked Options - Total Equity Linked Compensation', 'Total - Total Annual Compensation', 'Accumulated Wealth - Shares', 'Accumulated Wealth - LTIPS(max)', 'Accumulated Wealth - Intrinsic Option', 'Accumulated Wealth - Estimated Option', 'Accumulated Wealth - Liquid Wealth', 'Total Wealth - Total Wealth']
df.shape: (499965, 55)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (140761, 55)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Org Summary - 2.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Profile - Characteristics - 1.xlsx
Unique workbook name: Director Profile - Characteristics
List of sheets to open: ['Charcteristics']
------
Sheet 0 : Charcteristics
% NaNs in first row: 73.3 > 30%, taking category = row 0 and variable name = row 1
df.shape: (500000, 15)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Director Name', 'DirectorID*', 'Age', 'DOB', 'DOD', 'Gender',
       'Nationality', 'Annual Report Year', 'Boards to Date - Quoted',
       'Boards to Date - Private', 'Boards to Date - Other',
       'Current Boards - Quoted', 'Current Boards - Private',
       'Current Boards - Other', 'Avg Years on Quoted Boards'],
      dtype='object')
List of cols to keep (after processing): ['Director Name', 'DirectorID*', 'Age', 'DOB', 'DOD', 'Gender', 'Nationality', 'Annual Report Year', 'Boards to Date - Quoted', 'Boards to Date - Private', 'Boards to Date - Other', 'Current Boards - Quoted', 'Current Boards - Private', 'Current Boards - Other', 'Avg Years on Quoted Boards']
df.shape: (500000, 15)
Done!
---
Filtering df by rows:
---
No column found that contains 'companyid', not filtering by rows.
df.shape: (500000, 15)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Profile - Characteristics - 1.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Org Summary - 3.xlsx
Unique workbook name: SMDEs Org Summary
List of sheets to open: ['Board Summary']
------
Sheet 0 : Board Summary
% NaNs in first row: 83.6 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499967, 61)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Country', 'CompanyID*', 'Company Name', 'ISIN',
       'Ticker', 'Index', 'Sector', 'Director Type', 'DirectorID*',
       'Individual Name', 'Characteristics of Roles - Individual Role',
       'Characteristics of Roles - Director Network Size',
       'Characteristics of Roles - Time to Retirement',
       'Characteristics of Roles - Time in Role',
       'Characteristics of Roles - Time on Board',
       'Characteristics of Roles - Time in Company',
       'Director Experience - Total Number of Quoted Boards to Date',
       'Director Experience - Total Number of Private Boards to Date',
       'Director Experience - Total Number of Other Boards to Date',
       'Director Experience - Total Number of Quoted Current Boards',
       'Director Experience - Total Number of Private Current Boards',
       'Director Experience - Total Number of Other Current Boards',
       'Director Experience - Avg. Yrs on Other Quoted Boards',
       'Director Experience - Age (Yrs)',
       'Director Experience - Number of Qualifications',
       'Director Experience - Gender', 'Director Experience - Nationality Mix',
       'Ratios - Bonus/ (Bonus&Salary)', 'Ratios - Equity Linked/ Total',
       'Ratios - Performance/ Total', 'Ratios - %Change from Last Period',
       'Ratios - Wealth Delta', 'Annual Direct Compensation - Salary',
       'Annual Direct Compensation - Bonus',
       'Annual Direct Compensation - D.C Pension',
       'Annual Direct Compensation - Other',
       'Annual Direct Compensation - Total Salary+Bonus',
       'Annual Direct Compensation - Total Inc. D.C. Pension & Other',
       'Annual- Equity Linked Options - Shares',
       'Annual- Equity Linked Options - LTIPS(max)',
       'Annual- Equity Linked Options - Vesting Date',
       'Annual- Equity Linked Options - Intrinsic Options (excercisable)',
       'Annual- Equity Linked Options - Intrinsic Options (unexercisable)',
       'Annual- Equity Linked Options - Estimated Options (exercisable)',
       'Annual- Equity Linked Options - Estimated Options (unexcercisable)',
       'Annual- Equity Linked Options - Share Price',
       'Annual- Equity Linked Options - Total Equity Linked Compensation',
       'Total - Total Annual Compensation', 'Accumulated Wealth - Shares',
       'Accumulated Wealth - LTIPS(max)',
       'Accumulated Wealth - Intrinsic Option',
       'Accumulated Wealth - Estimated Option',
       'Accumulated Wealth - Liquid Wealth', 'Total Wealth - Total Wealth',
       'Committee Members - AUDIT COMMITTEE MEMBER (if yes then put M)',
       'Committee Members - REMUNERATION/ COMPENSATION COMMITTEE MEMBER',
       'Committee Members - NOMINATION COMMITTEE MEMBER',
       'Committee Size - AUDIT COMMITTEE SIZE',
       'Committee Size - REMUNERATION/ COMPENSATION COMMITTEE SIZE',
       'Committee Size - NOMINATION COMMITTEE SIZE'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Country', 'CompanyID*', 'Company Name', 'ISIN', 'Ticker', 'Index', 'Sector', 'Director Type', 'DirectorID*', 'Individual Name', 'Characteristics of Roles - Individual Role', 'Characteristics of Roles - Director Network Size', 'Characteristics of Roles - Time to Retirement', 'Characteristics of Roles - Time in Role', 'Characteristics of Roles - Time on Board', 'Characteristics of Roles - Time in Company', 'Director Experience - Total Number of Quoted Boards to Date', 'Director Experience - Total Number of Private Boards to Date', 'Director Experience - Total Number of Other Boards to Date', 'Director Experience - Total Number of Quoted Current Boards', 'Director Experience - Total Number of Private Current Boards', 'Director Experience - Total Number of Other Current Boards', 'Director Experience - Avg. Yrs on Other Quoted Boards', 'Director Experience - Age (Yrs)', 'Director Experience - Number of Qualifications', 'Director Experience - Gender', 'Director Experience - Nationality Mix', 'Ratios - Bonus/ (Bonus&Salary)', 'Ratios - Equity Linked/ Total', 'Ratios - Performance/ Total', 'Ratios - %Change from Last Period', 'Ratios - Wealth Delta', 'Annual Direct Compensation - Salary', 'Annual Direct Compensation - Bonus', 'Annual Direct Compensation - D.C Pension', 'Annual Direct Compensation - Other', 'Annual Direct Compensation - Total Salary+Bonus', 'Annual Direct Compensation - Total Inc. D.C. Pension & Other', 'Annual- Equity Linked Options - Shares', 'Annual- Equity Linked Options - LTIPS(max)', 'Annual- Equity Linked Options - Vesting Date', 'Annual- Equity Linked Options - Intrinsic Options (excercisable)', 'Annual- Equity Linked Options - Intrinsic Options (unexercisable)', 'Annual- Equity Linked Options - Estimated Options (exercisable)', 'Annual- Equity Linked Options - Estimated Options (unexcercisable)', 'Annual- Equity Linked Options - Share Price', 'Annual- Equity Linked Options - Total Equity Linked Compensation', 'Total - Total Annual Compensation', 'Accumulated Wealth - Shares', 'Accumulated Wealth - LTIPS(max)', 'Accumulated Wealth - Intrinsic Option', 'Accumulated Wealth - Estimated Option', 'Accumulated Wealth - Liquid Wealth', 'Total Wealth - Total Wealth']
df.shape: (499967, 55)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (200288, 55)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Org Summary - 3.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Profile - Employment Current Board.xlsx
Unique workbook name: Director Profile - Employment Current Board
List of sheets to open: ['Current Board Role']
------
Sheet 0 : Current Board Role
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (232832, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED', 'Start Date',
       'Committee Name', 'Committee Role'],
      dtype='object')
List of cols to keep (after processing): ['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name', 'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name', 'Company Type', 'Role', 'Role Description', 'ED/NED', 'Start Date', 'Committee Name', 'Committee Role']
df.shape: (232832, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (27001, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Profile - Employment Current Board.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Profile - Education & Achievements.xlsx
Unique workbook name: SMDEs Profile - Education & Achievements
List of sheets to open: ['Education', 'Achievements']
------
Sheet 0 : Education
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (751101, 9)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'InstitutionID*',
       'Institution Name', 'Company Type', 'Qualification',
       'Qualification Description', 'Qualification Date'],
      dtype='object')
List of cols to keep (after processing): ['Country', 'DirectorID*', 'Director Name', 'InstitutionID*', 'Institution Name', 'Company Type', 'Qualification', 'Qualification Description', 'Qualification Date']
df.shape: (751101, 9)
Done!
---
Filtering df by rows:
---
No column found that contains 'companyid', not filtering by rows.
df.shape: (751101, 9)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Profile - Education & Achievements_Education.xlsx
Done!
------
Sheet 1 : Achievements
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (416221, 7)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'OrganisationID*',
       'OrganisationName', 'Achievement Date', 'Award/Achievement'],
      dtype='object')
List of cols to keep (after processing): ['Country', 'DirectorID*', 'Director Name', 'OrganisationID*', 'OrganisationName', 'Achievement Date', 'Award/Achievement']
df.shape: (416221, 7)
Done!
---
Filtering df by rows:
---
No column found that contains 'companyid', not filtering by rows.
df.shape: (416221, 7)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Profile - Education & Achievements_Achievements.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Profile - Other Activities.xlsx
Unique workbook name: Director Profile - Other Activities
List of sheets to open: ['Current Other Activities Tab']
------
Sheet 0 : Current Other Activities Tab
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (179186, 8)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Role', 'Role Description', 'Start Date'],
      dtype='object')
List of cols to keep (after processing): ['Country', 'DirectorID*', 'Director Name', 'CompanyID*']
df.shape: (179186, 4)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (4, 4)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Profile - Other Activities.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Profile - Characteristics - 2.xlsx
Unique workbook name: Director Profile - Characteristics
List of sheets to open: ['Charcteristics']
------
Sheet 0 : Charcteristics
% NaNs in first row: 73.3 > 30%, taking category = row 0 and variable name = row 1
df.shape: (354880, 15)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Director Name', 'DirectorID*', 'Age', 'DOB', 'DOD', 'Gender',
       'Nationality', 'Annual Report Year', 'Boards to Date - Quoted',
       'Boards to Date - Private', 'Boards to Date - Other',
       'Current Boards - Quoted', 'Current Boards - Private',
       'Current Boards - Other', 'Avg Years on Quoted Boards'],
      dtype='object')
List of cols to keep (after processing): ['Director Name', 'DirectorID*', 'Age', 'DOB', 'DOD', 'Gender', 'Nationality', 'Annual Report Year', 'Boards to Date - Quoted', 'Boards to Date - Private', 'Boards to Date - Other', 'Current Boards - Quoted', 'Current Boards - Private', 'Current Boards - Other', 'Avg Years on Quoted Boards']
df.shape: (354880, 15)
Done!
---
Filtering df by rows:
---
No column found that contains 'companyid', not filtering by rows.
df.shape: (354880, 15)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Profile - Characteristics - 2.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Profile - Employment Historical NonBoard - 3.xlsx
Unique workbook name: SMDEs Profile - Employment Historical NonBoard
List of sheets to open: ['Historic Non Board Role']
------
Sheet 0 : Historic Non Board Role
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (500000, 15)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED/SM', 'Start Date',
       'End Date'],
      dtype='object')
List of cols to keep (after processing): ['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name', 'Company ISIN', 'Company Ticker', 'Company Index']
df.shape: (500000, 8)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (56715, 8)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Profile - Employment Historical NonBoard - 3.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Profile - Employment Historical Board - 2.xlsx
Unique workbook name: Director Profile - Employment Historical Board
List of sheets to open: ['Historic Board Role']
------
Sheet 0 : Historic Board Role
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (440311, 17)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED', 'Start Date',
       'End Date', 'Committee Name', 'Committee Role'],
      dtype='object')
List of cols to keep (after processing): ['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name', 'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name', 'Company Type', 'Role', 'Role Description']
df.shape: (440311, 12)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (69318, 12)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Profile - Employment Historical Board - 2.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Company Announcements.xlsx
Unique workbook name: Company Announcements
List of sheets to open: ['Announcements']
------
Sheet 0 : Announcements
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (96017, 10)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Announcement Date', 'Effective Date', 'CompanyID*', 'Company Name',
       'ISIN', 'DirectorID*', 'Director Name', 'Gender', 'Role',
       'Description'],
      dtype='object')
List of cols to keep (after processing): ['CompanyID*', 'Company Name', 'ISIN', 'DirectorID*', 'Director Name']
df.shape: (96017, 5)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (33637, 5)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Company Announcements.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - Director Profile - Employment Historical NonBoard - 2.xlsx
Unique workbook name: Director Profile - Employment Historical NonBoard
List of sheets to open: ['Historic Non Board Role']
------
Sheet 0 : Historic Non Board Role
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (258245, 15)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED/SM', 'Start Date',
       'End Date'],
      dtype='object')
List of cols to keep (after processing): ['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name', 'Company ISIN', 'Company Ticker', 'Company Index']
df.shape: (258245, 8)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (31996, 8)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - Director Profile - Employment Historical NonBoard - 2.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Org Summary - 4.xlsx
Unique workbook name: SMDEs Org Summary
List of sheets to open: ['Board Summary']
------
Sheet 0 : Board Summary
% NaNs in first row: 83.6 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499218, 61)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Country', 'CompanyID*', 'Company Name', 'ISIN',
       'Ticker', 'Index', 'Sector', 'Director Type', 'DirectorID*',
       'Individual Name', 'Characteristics of Roles - Individual Role',
       'Characteristics of Roles - Director Network Size',
       'Characteristics of Roles - Time to Retirement',
       'Characteristics of Roles - Time in Role',
       'Characteristics of Roles - Time on Board',
       'Characteristics of Roles - Time in Company',
       'Director Experience - Total Number of Quoted Boards to Date',
       'Director Experience - Total Number of Private Boards to Date',
       'Director Experience - Total Number of Other Boards to Date',
       'Director Experience - Total Number of Quoted Current Boards',
       'Director Experience - Total Number of Private Current Boards',
       'Director Experience - Total Number of Other Current Boards',
       'Director Experience - Avg. Yrs on Other Quoted Boards',
       'Director Experience - Age (Yrs)',
       'Director Experience - Number of Qualifications',
       'Director Experience - Gender', 'Director Experience - Nationality Mix',
       'Ratios - Bonus/ (Bonus&Salary)', 'Ratios - Equity Linked/ Total',
       'Ratios - Performance/ Total', 'Ratios - %Change from Last Period',
       'Ratios - Wealth Delta', 'Annual Direct Compensation - Salary',
       'Annual Direct Compensation - Bonus',
       'Annual Direct Compensation - D.C Pension',
       'Annual Direct Compensation - Other',
       'Annual Direct Compensation - Total Salary+Bonus',
       'Annual Direct Compensation - Total Inc. D.C. Pension & Other',
       'Annual- Equity Linked Options - Shares',
       'Annual- Equity Linked Options - LTIPS(max)',
       'Annual- Equity Linked Options - Vesting Date',
       'Annual- Equity Linked Options - Intrinsic Options (excercisable)',
       'Annual- Equity Linked Options - Intrinsic Options (unexercisable)',
       'Annual- Equity Linked Options - Estimated Options (exercisable)',
       'Annual- Equity Linked Options - Estimated Options (unexcercisable)',
       'Annual- Equity Linked Options - Share Price',
       'Annual- Equity Linked Options - Total Equity Linked Compensation',
       'Total - Total Annual Compensation', 'Accumulated Wealth - Shares',
       'Accumulated Wealth - LTIPS(max)',
       'Accumulated Wealth - Intrinsic Option',
       'Accumulated Wealth - Estimated Option',
       'Accumulated Wealth - Liquid Wealth', 'Total Wealth - Total Wealth',
       'Committee Members - AUDIT COMMITTEE MEMBER (if yes then put M)',
       'Committee Members - REMUNERATION/ COMPENSATION COMMITTEE MEMBER',
       'Committee Members - NOMINATION COMMITTEE MEMBER',
       'Committee Size - AUDIT COMMITTEE SIZE',
       'Committee Size - REMUNERATION/ COMPENSATION COMMITTEE SIZE',
       'Committee Size - NOMINATION COMMITTEE SIZE'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Country', 'CompanyID*', 'Company Name', 'ISIN', 'Ticker', 'Index', 'Sector', 'Director Type', 'DirectorID*', 'Individual Name', 'Characteristics of Roles - Individual Role', 'Characteristics of Roles - Director Network Size', 'Characteristics of Roles - Time to Retirement', 'Characteristics of Roles - Time in Role', 'Characteristics of Roles - Time on Board', 'Characteristics of Roles - Time in Company', 'Director Experience - Total Number of Quoted Boards to Date', 'Director Experience - Total Number of Private Boards to Date', 'Director Experience - Total Number of Other Boards to Date', 'Director Experience - Total Number of Quoted Current Boards', 'Director Experience - Total Number of Private Current Boards', 'Director Experience - Total Number of Other Current Boards', 'Director Experience - Avg. Yrs on Other Quoted Boards', 'Director Experience - Age (Yrs)', 'Director Experience - Number of Qualifications', 'Director Experience - Gender', 'Director Experience - Nationality Mix', 'Ratios - Bonus/ (Bonus&Salary)', 'Ratios - Equity Linked/ Total', 'Ratios - Performance/ Total', 'Ratios - %Change from Last Period', 'Ratios - Wealth Delta', 'Annual Direct Compensation - Salary', 'Annual Direct Compensation - Bonus', 'Annual Direct Compensation - D.C Pension', 'Annual Direct Compensation - Other', 'Annual Direct Compensation - Total Salary+Bonus', 'Annual Direct Compensation - Total Inc. D.C. Pension & Other', 'Annual- Equity Linked Options - Shares', 'Annual- Equity Linked Options - LTIPS(max)', 'Annual- Equity Linked Options - Vesting Date', 'Annual- Equity Linked Options - Intrinsic Options (excercisable)', 'Annual- Equity Linked Options - Intrinsic Options (unexercisable)', 'Annual- Equity Linked Options - Estimated Options (exercisable)', 'Annual- Equity Linked Options - Estimated Options (unexcercisable)', 'Annual- Equity Linked Options - Share Price', 'Annual- Equity Linked Options - Total Equity Linked Compensation', 'Total - Total Annual Compensation', 'Accumulated Wealth - Shares', 'Accumulated Wealth - LTIPS(max)', 'Accumulated Wealth - Intrinsic Option', 'Accumulated Wealth - Estimated Option', 'Accumulated Wealth - Liquid Wealth', 'Total Wealth - Total Wealth']
df.shape: (499218, 55)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (150512, 55)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Org Summary - 4.xlsx
Done!
-----------------------------------------------------------
File name (kept): NA - SMDEs Org Summary - 5.xlsx
Unique workbook name: SMDEs Org Summary
List of sheets to open: ['Board Summary']
------
Sheet 0 : Board Summary
% NaNs in first row: 83.6 > 30%, taking category = row 0 and variable name = row 1
df.shape: (409942, 61)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Country', 'CompanyID*', 'Company Name', 'ISIN',
       'Ticker', 'Index', 'Sector', 'Director Type', 'DirectorID*',
       'Individual Name', 'Characteristics of Roles - Individual Role',
       'Characteristics of Roles - Director Network Size',
       'Characteristics of Roles - Time to Retirement',
       'Characteristics of Roles - Time in Role',
       'Characteristics of Roles - Time on Board',
       'Characteristics of Roles - Time in Company',
       'Director Experience - Total Number of Quoted Boards to Date',
       'Director Experience - Total Number of Private Boards to Date',
       'Director Experience - Total Number of Other Boards to Date',
       'Director Experience - Total Number of Quoted Current Boards',
       'Director Experience - Total Number of Private Current Boards',
       'Director Experience - Total Number of Other Current Boards',
       'Director Experience - Avg. Yrs on Other Quoted Boards',
       'Director Experience - Age (Yrs)',
       'Director Experience - Number of Qualifications',
       'Director Experience - Gender', 'Director Experience - Nationality Mix',
       'Ratios - Bonus/ (Bonus&Salary)', 'Ratios - Equity Linked/ Total',
       'Ratios - Performance/ Total', 'Ratios - %Change from Last Period',
       'Ratios - Wealth Delta', 'Annual Direct Compensation - Salary',
       'Annual Direct Compensation - Bonus',
       'Annual Direct Compensation - D.C Pension',
       'Annual Direct Compensation - Other',
       'Annual Direct Compensation - Total Salary+Bonus',
       'Annual Direct Compensation - Total Inc. D.C. Pension & Other',
       'Annual- Equity Linked Options - Shares',
       'Annual- Equity Linked Options - LTIPS(max)',
       'Annual- Equity Linked Options - Vesting Date',
       'Annual- Equity Linked Options - Intrinsic Options (excercisable)',
       'Annual- Equity Linked Options - Intrinsic Options (unexercisable)',
       'Annual- Equity Linked Options - Estimated Options (exercisable)',
       'Annual- Equity Linked Options - Estimated Options (unexcercisable)',
       'Annual- Equity Linked Options - Share Price',
       'Annual- Equity Linked Options - Total Equity Linked Compensation',
       'Total - Total Annual Compensation', 'Accumulated Wealth - Shares',
       'Accumulated Wealth - LTIPS(max)',
       'Accumulated Wealth - Intrinsic Option',
       'Accumulated Wealth - Estimated Option',
       'Accumulated Wealth - Liquid Wealth', 'Total Wealth - Total Wealth',
       'Committee Members - AUDIT COMMITTEE MEMBER (if yes then put M)',
       'Committee Members - REMUNERATION/ COMPENSATION COMMITTEE MEMBER',
       'Committee Members - NOMINATION COMMITTEE MEMBER',
       'Committee Size - AUDIT COMMITTEE SIZE',
       'Committee Size - REMUNERATION/ COMPENSATION COMMITTEE SIZE',
       'Committee Size - NOMINATION COMMITTEE SIZE'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Country', 'CompanyID*', 'Company Name', 'ISIN', 'Ticker', 'Index', 'Sector', 'Director Type', 'DirectorID*', 'Individual Name', 'Characteristics of Roles - Individual Role', 'Characteristics of Roles - Director Network Size', 'Characteristics of Roles - Time to Retirement', 'Characteristics of Roles - Time in Role', 'Characteristics of Roles - Time on Board', 'Characteristics of Roles - Time in Company', 'Director Experience - Total Number of Quoted Boards to Date', 'Director Experience - Total Number of Private Boards to Date', 'Director Experience - Total Number of Other Boards to Date', 'Director Experience - Total Number of Quoted Current Boards', 'Director Experience - Total Number of Private Current Boards', 'Director Experience - Total Number of Other Current Boards', 'Director Experience - Avg. Yrs on Other Quoted Boards', 'Director Experience - Age (Yrs)', 'Director Experience - Number of Qualifications', 'Director Experience - Gender', 'Director Experience - Nationality Mix', 'Ratios - Bonus/ (Bonus&Salary)', 'Ratios - Equity Linked/ Total', 'Ratios - Performance/ Total', 'Ratios - %Change from Last Period', 'Ratios - Wealth Delta', 'Annual Direct Compensation - Salary', 'Annual Direct Compensation - Bonus', 'Annual Direct Compensation - D.C Pension', 'Annual Direct Compensation - Other', 'Annual Direct Compensation - Total Salary+Bonus', 'Annual Direct Compensation - Total Inc. D.C. Pension & Other', 'Annual- Equity Linked Options - Shares', 'Annual- Equity Linked Options - LTIPS(max)', 'Annual- Equity Linked Options - Vesting Date', 'Annual- Equity Linked Options - Intrinsic Options (excercisable)', 'Annual- Equity Linked Options - Intrinsic Options (unexercisable)', 'Annual- Equity Linked Options - Estimated Options (exercisable)', 'Annual- Equity Linked Options - Estimated Options (unexcercisable)', 'Annual- Equity Linked Options - Share Price', 'Annual- Equity Linked Options - Total Equity Linked Compensation', 'Total - Total Annual Compensation', 'Accumulated Wealth - Shares', 'Accumulated Wealth - LTIPS(max)', 'Accumulated Wealth - Intrinsic Option', 'Accumulated Wealth - Estimated Option', 'Accumulated Wealth - Liquid Wealth', 'Total Wealth - Total Wealth']
df.shape: (409942, 55)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (92501, 55)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/NA - SMDEs Org Summary - 5.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 1.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497244, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497244, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (119411, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 1.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 102.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499674, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499674, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (28592, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 102.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 111.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499844, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499844, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (44992, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 111.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 106.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499958, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499958, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (39038, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 106.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 11.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (12456, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (12456, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (2056, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 11.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 24.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498336, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498336, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (50666, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 24.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 141.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499704, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499704, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (26829, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 141.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 135.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499273, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499273, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (28224, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 135.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 34.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498851, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498851, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (51420, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 34.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 45.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499213, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499213, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (32023, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 45.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 112.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499223, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499223, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (51680, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 112.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 149.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499797, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499797, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (15802, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 149.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 119.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499948, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499948, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (33381, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 119.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 29.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499161, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499161, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (63395, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 29.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 107.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499997, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499997, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (37211, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 107.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 120.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499062, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499062, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (31576, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 120.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 145.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496820, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496820, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (38885, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 145.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 37.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496981, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496981, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (55960, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 37.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 23.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499169, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499169, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (72730, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 23.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 127.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496537, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496537, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (37688, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 127.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 108.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499475, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499475, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (50546, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 108.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 146.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499905, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499905, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (35136, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 146.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 46.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499686, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499686, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (55884, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 46.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 142.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497573, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497573, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (19984, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 142.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 15.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497619, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497619, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (92775, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 15.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 154.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (4249, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (4249, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (0, 22)
Note: df has no rows and/or columns!
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 139.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497001, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497001, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (27883, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 139.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 124.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499639, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499639, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (39499, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 124.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 13.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499229, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499229, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (81141, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 13.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 133.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499260, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499260, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (34792, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 133.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 28.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498573, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498573, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (81542, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 28.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 103.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497481, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497481, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (34297, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 103.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 151.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499789, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499789, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (23794, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 151.xlsx
Done!
-----------------------------------------------------------
File name (kept): ROW - Director Network - 104.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498879, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
/home/jasonjia/.local/lib/python3.8/site-packages/openpyxl/worksheet/_reader.py:329: UserWarning: Conditional Formatting extension is not supported and will be removed
  warn(msg)
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498879, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (43460, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/ROW - Director Network - 104.xlsx
Done!
-----------------------------------------------------------
List of files kept: ['NA - SMDEs Profile - Employment Historical Board.xlsx', 'NA - Director Details Mapping File.xlsx', 'NA - SMDEs Profile - Employment Current Board.xlsx', 'NA - SMDEs Org Summary - 2.xlsx', 'NA - Director Profile - Characteristics - 1.xlsx', 'NA - SMDEs Org Summary - 3.xlsx', 'NA - Director Profile - Employment Current Board.xlsx', 'NA - SMDEs Profile - Education & Achievements.xlsx', 'NA - Director Profile - Other Activities.xlsx', 'NA - Director Profile - Characteristics - 2.xlsx', 'NA - SMDEs Profile - Employment Historical NonBoard - 3.xlsx', 'NA - Director Profile - Employment Historical Board - 2.xlsx', 'NA - Company Announcements.xlsx', 'NA - Director Profile - Employment Historical NonBoard - 2.xlsx', 'NA - SMDEs Org Summary - 4.xlsx', 'NA - SMDEs Org Summary - 5.xlsx', 'ROW - Director Network - 1.xlsx', 'ROW - Director Network - 102.xlsx', 'ROW - Director Network - 111.xlsx', 'ROW - Director Network - 106.xlsx', 'ROW - Director Network - 11.xlsx', 'ROW - Director Network - 24.xlsx', 'ROW - Director Network - 141.xlsx', 'ROW - Director Network - 135.xlsx', 'ROW - Director Network - 34.xlsx', 'ROW - Director Network - 45.xlsx', 'ROW - Director Network - 112.xlsx', 'ROW - Director Network - 149.xlsx', 'ROW - Director Network - 119.xlsx', 'ROW - Director Network - 29.xlsx', 'ROW - Director Network - 107.xlsx', 'ROW - Director Network - 120.xlsx', 'ROW - Director Network - 145.xlsx', 'ROW - Director Network - 37.xlsx', 'ROW - Director Network - 23.xlsx', 'ROW - Director Network - 127.xlsx', 'ROW - Director Network - 108.xlsx', 'ROW - Director Network - 146.xlsx', 'ROW - Director Network - 46.xlsx', 'ROW - Director Network - 142.xlsx', 'ROW - Director Network - 15.xlsx', 'ROW - Director Network - 154.xlsx', 'ROW - Director Network - 139.xlsx', 'ROW - Director Network - 124.xlsx', 'ROW - Director Network - 13.xlsx', 'ROW - Director Network - 133.xlsx', 'ROW - Director Network - 28.xlsx', 'ROW - Director Network - 103.xlsx', 'ROW - Director Network - 151.xlsx', 'ROW - Director Network - 104.xlsx']
------
List of files not kept: []
Done!
