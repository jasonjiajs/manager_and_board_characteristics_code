-----------------------------------------------------------
Output from Shell Script:
Job ID: 10634308
Job User: jasonjia
Num Cores: 1
Array(Task ID): 58 of 64
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: openpyxl in /home/jasonjia/.local/lib/python3.8/site-packages (3.1.2)
Requirement already satisfied: et-xmlfile in /home/jasonjia/.local/lib/python3.8/site-packages (from openpyxl) (1.1.0)

[notice] A new release of pip is available: 23.0.1 -> 23.1.2
[notice] To update, run: pip install --upgrade pip
Program Path: filter_boardex_by_columns_and_rows.py
Filepath of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_010523.xlsx
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Input Folder: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex
Output Folder: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows
-----------------------------------------------------------
Output from Python Script:
This is array 58 / 64
Filepath of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_010523.xlsx
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Input Folder (containing raw BoardEx .xlsx files): /project/kh_mercury_1/manager_and_board_characteristics/data/boardex
Output Folder (after we filter by both columns and rows): /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows
Total number of files in input folder: 3246
This process will cover file(s): 2851 to 2900
-----------------------------------------------------------
File name (kept): UK - Company Network - 1.xlsx
Unique workbook name: Company Network
List of sheets to open: ['Company Network']
------
Sheet 0 : Company Network
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (499243, 26)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Start Company', 'Start CompanyID*', 'Start Company Index',
       'Start Company Sector', 'Start Company Country', 'Start Company Type',
       'Connected Company', 'Connected CompanyID*', 'Connected Company Index',
       'Connected Company Sector', 'Connected Company Country',
       'Connected Company Type', 'Director Name', 'DirectorID*',
       'Connected Company Current/Historic', 'Connected Company Duration',
       'Connected Company Role Name', 'ED/NED/Non-Brd',
       'Connected Company Role Start Date', 'Connected Company Role End Date',
       'Start Company Current/Historic', 'Start Company Duration',
       'Start Company Role', 'Start ED/NED/Non-Brd',
       'Start Company Role Start Date', 'Start Company Role End Date'],
      dtype='object')
List of cols to keep (after processing): ['Start Company', 'Start CompanyID*', 'Start Company Index', 'Start Company Sector', 'Start Company Country', 'Start Company Type', 'Connected Company', 'Connected CompanyID*', 'Connected Company Index', 'Connected Company Sector', 'Connected Company Country', 'Connected Company Type', 'Director Name', 'DirectorID*', 'Connected Company Current/Historic', 'Connected Company Duration', 'Connected Company Role Name', 'ED/NED/Non-Brd', 'Connected Company Role Start Date', 'Connected Company Role End Date', 'Start Company Current/Historic', 'Start Company Duration', 'Start Company Role', 'Start ED/NED/Non-Brd', 'Start Company Role Start Date', 'Start Company Role End Date']
df.shape: (499243, 26)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (77438, 26)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Company Network - 1.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Company Network - 5.xlsx
Unique workbook name: Company Network
List of sheets to open: ['Company Network']
------
Sheet 0 : Company Network
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (499096, 26)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Start Company', 'Start CompanyID*', 'Start Company Index',
       'Start Company Sector', 'Start Company Country', 'Start Company Type',
       'Connected Company', 'Connected CompanyID*', 'Connected Company Index',
       'Connected Company Sector', 'Connected Company Country',
       'Connected Company Type', 'Director Name', 'DirectorID*',
       'Connected Company Current/Historic', 'Connected Company Duration',
       'Connected Company Role Name', 'ED/NED/Non-Brd',
       'Connected Company Role Start Date', 'Connected Company Role End Date',
       'Start Company Current/Historic', 'Start Company Duration',
       'Start Company Role', 'Start ED/NED/Non-Brd',
       'Start Company Role Start Date', 'Start Company Role End Date'],
      dtype='object')
List of cols to keep (after processing): ['Start Company', 'Start CompanyID*', 'Start Company Index', 'Start Company Sector', 'Start Company Country', 'Start Company Type', 'Connected Company', 'Connected CompanyID*', 'Connected Company Index', 'Connected Company Sector', 'Connected Company Country', 'Connected Company Type', 'Director Name', 'DirectorID*', 'Connected Company Current/Historic', 'Connected Company Duration', 'Connected Company Role Name', 'ED/NED/Non-Brd', 'Connected Company Role Start Date', 'Connected Company Role End Date', 'Start Company Current/Historic', 'Start Company Duration', 'Start Company Role', 'Start ED/NED/Non-Brd', 'Start Company Role Start Date', 'Start Company Role End Date']
df.shape: (499096, 26)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (108122, 26)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Company Network - 5.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Company Network - 2.xlsx
Unique workbook name: Company Network
List of sheets to open: ['Company Network']
------
Sheet 0 : Company Network
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (497813, 26)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Start Company', 'Start CompanyID*', 'Start Company Index',
       'Start Company Sector', 'Start Company Country', 'Start Company Type',
       'Connected Company', 'Connected CompanyID*', 'Connected Company Index',
       'Connected Company Sector', 'Connected Company Country',
       'Connected Company Type', 'Director Name', 'DirectorID*',
       'Connected Company Current/Historic', 'Connected Company Duration',
       'Connected Company Role Name', 'ED/NED/Non-Brd',
       'Connected Company Role Start Date', 'Connected Company Role End Date',
       'Start Company Current/Historic', 'Start Company Duration',
       'Start Company Role', 'Start ED/NED/Non-Brd',
       'Start Company Role Start Date', 'Start Company Role End Date'],
      dtype='object')
List of cols to keep (after processing): ['Start Company', 'Start CompanyID*', 'Start Company Index', 'Start Company Sector', 'Start Company Country', 'Start Company Type', 'Connected Company', 'Connected CompanyID*', 'Connected Company Index', 'Connected Company Sector', 'Connected Company Country', 'Connected Company Type', 'Director Name', 'DirectorID*', 'Connected Company Current/Historic', 'Connected Company Duration', 'Connected Company Role Name', 'ED/NED/Non-Brd', 'Connected Company Role Start Date', 'Connected Company Role End Date', 'Start Company Current/Historic', 'Start Company Duration', 'Start Company Role', 'Start ED/NED/Non-Brd', 'Start Company Role Start Date', 'Start Company Role End Date']
df.shape: (497813, 26)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (68045, 26)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Company Network - 2.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Company Network - 4.xlsx
Unique workbook name: Company Network
List of sheets to open: ['Company Network']
------
Sheet 0 : Company Network
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (499608, 26)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Start Company', 'Start CompanyID*', 'Start Company Index',
       'Start Company Sector', 'Start Company Country', 'Start Company Type',
       'Connected Company', 'Connected CompanyID*', 'Connected Company Index',
       'Connected Company Sector', 'Connected Company Country',
       'Connected Company Type', 'Director Name', 'DirectorID*',
       'Connected Company Current/Historic', 'Connected Company Duration',
       'Connected Company Role Name', 'ED/NED/Non-Brd',
       'Connected Company Role Start Date', 'Connected Company Role End Date',
       'Start Company Current/Historic', 'Start Company Duration',
       'Start Company Role', 'Start ED/NED/Non-Brd',
       'Start Company Role Start Date', 'Start Company Role End Date'],
      dtype='object')
List of cols to keep (after processing): ['Start Company', 'Start CompanyID*', 'Start Company Index', 'Start Company Sector', 'Start Company Country', 'Start Company Type', 'Connected Company', 'Connected CompanyID*', 'Connected Company Index', 'Connected Company Sector', 'Connected Company Country', 'Connected Company Type', 'Director Name', 'DirectorID*', 'Connected Company Current/Historic', 'Connected Company Duration', 'Connected Company Role Name', 'ED/NED/Non-Brd', 'Connected Company Role Start Date', 'Connected Company Role End Date', 'Start Company Current/Historic', 'Start Company Duration', 'Start Company Role', 'Start ED/NED/Non-Brd', 'Start Company Role Start Date', 'Start Company Role End Date']
df.shape: (499608, 26)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (52390, 26)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Company Network - 4.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Company Network - 7.xlsx
Unique workbook name: Company Network
List of sheets to open: ['Company Network']
------
Sheet 0 : Company Network
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (499344, 26)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Start Company', 'Start CompanyID*', 'Start Company Index',
       'Start Company Sector', 'Start Company Country', 'Start Company Type',
       'Connected Company', 'Connected CompanyID*', 'Connected Company Index',
       'Connected Company Sector', 'Connected Company Country',
       'Connected Company Type', 'Director Name', 'DirectorID*',
       'Connected Company Current/Historic', 'Connected Company Duration',
       'Connected Company Role Name', 'ED/NED/Non-Brd',
       'Connected Company Role Start Date', 'Connected Company Role End Date',
       'Start Company Current/Historic', 'Start Company Duration',
       'Start Company Role', 'Start ED/NED/Non-Brd',
       'Start Company Role Start Date', 'Start Company Role End Date'],
      dtype='object')
List of cols to keep (after processing): ['Start Company', 'Start CompanyID*', 'Start Company Index', 'Start Company Sector', 'Start Company Country', 'Start Company Type', 'Connected Company', 'Connected CompanyID*', 'Connected Company Index', 'Connected Company Sector', 'Connected Company Country', 'Connected Company Type', 'Director Name', 'DirectorID*', 'Connected Company Current/Historic', 'Connected Company Duration', 'Connected Company Role Name', 'ED/NED/Non-Brd', 'Connected Company Role Start Date', 'Connected Company Role End Date', 'Start Company Current/Historic', 'Start Company Duration', 'Start Company Role', 'Start ED/NED/Non-Brd', 'Start Company Role Start Date', 'Start Company Role End Date']
df.shape: (499344, 26)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (99821, 26)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Company Network - 7.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Company Network - 6.xlsx
Unique workbook name: Company Network
List of sheets to open: ['Company Network']
------
Sheet 0 : Company Network
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (499352, 26)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Start Company', 'Start CompanyID*', 'Start Company Index',
       'Start Company Sector', 'Start Company Country', 'Start Company Type',
       'Connected Company', 'Connected CompanyID*', 'Connected Company Index',
       'Connected Company Sector', 'Connected Company Country',
       'Connected Company Type', 'Director Name', 'DirectorID*',
       'Connected Company Current/Historic', 'Connected Company Duration',
       'Connected Company Role Name', 'ED/NED/Non-Brd',
       'Connected Company Role Start Date', 'Connected Company Role End Date',
       'Start Company Current/Historic', 'Start Company Duration',
       'Start Company Role', 'Start ED/NED/Non-Brd',
       'Start Company Role Start Date', 'Start Company Role End Date'],
      dtype='object')
List of cols to keep (after processing): ['Start Company', 'Start CompanyID*', 'Start Company Index', 'Start Company Sector', 'Start Company Country', 'Start Company Type', 'Connected Company', 'Connected CompanyID*', 'Connected Company Index', 'Connected Company Sector', 'Connected Company Country', 'Connected Company Type', 'Director Name', 'DirectorID*', 'Connected Company Current/Historic', 'Connected Company Duration', 'Connected Company Role Name', 'ED/NED/Non-Brd', 'Connected Company Role Start Date', 'Connected Company Role End Date', 'Start Company Current/Historic', 'Start Company Duration', 'Start Company Role', 'Start ED/NED/Non-Brd', 'Start Company Role Start Date', 'Start Company Role End Date']
df.shape: (499352, 26)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (58315, 26)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Company Network - 6.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Company Network - 8.xlsx
Unique workbook name: Company Network
List of sheets to open: ['Company Network']
------
Sheet 0 : Company Network
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (499713, 26)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Start Company', 'Start CompanyID*', 'Start Company Index',
       'Start Company Sector', 'Start Company Country', 'Start Company Type',
       'Connected Company', 'Connected CompanyID*', 'Connected Company Index',
       'Connected Company Sector', 'Connected Company Country',
       'Connected Company Type', 'Director Name', 'DirectorID*',
       'Connected Company Current/Historic', 'Connected Company Duration',
       'Connected Company Role Name', 'ED/NED/Non-Brd',
       'Connected Company Role Start Date', 'Connected Company Role End Date',
       'Start Company Current/Historic', 'Start Company Duration',
       'Start Company Role', 'Start ED/NED/Non-Brd',
       'Start Company Role Start Date', 'Start Company Role End Date'],
      dtype='object')
List of cols to keep (after processing): ['Start Company', 'Start CompanyID*', 'Start Company Index', 'Start Company Sector', 'Start Company Country', 'Start Company Type', 'Connected Company', 'Connected CompanyID*', 'Connected Company Index', 'Connected Company Sector', 'Connected Company Country', 'Connected Company Type', 'Director Name', 'DirectorID*', 'Connected Company Current/Historic', 'Connected Company Duration', 'Connected Company Role Name', 'ED/NED/Non-Brd', 'Connected Company Role Start Date', 'Connected Company Role End Date', 'Start Company Current/Historic', 'Start Company Duration', 'Start Company Role', 'Start ED/NED/Non-Brd', 'Start Company Role Start Date', 'Start Company Role End Date']
df.shape: (499713, 26)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (92007, 26)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Company Network - 8.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Company Network - 9.xlsx
Unique workbook name: Company Network
List of sheets to open: ['Company Network']
------
Sheet 0 : Company Network
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (495419, 26)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Start Company', 'Start CompanyID*', 'Start Company Index',
       'Start Company Sector', 'Start Company Country', 'Start Company Type',
       'Connected Company', 'Connected CompanyID*', 'Connected Company Index',
       'Connected Company Sector', 'Connected Company Country',
       'Connected Company Type', 'Director Name', 'DirectorID*',
       'Connected Company Current/Historic', 'Connected Company Duration',
       'Connected Company Role Name', 'ED/NED/Non-Brd',
       'Connected Company Role Start Date', 'Connected Company Role End Date',
       'Start Company Current/Historic', 'Start Company Duration',
       'Start Company Role', 'Start ED/NED/Non-Brd',
       'Start Company Role Start Date', 'Start Company Role End Date'],
      dtype='object')
List of cols to keep (after processing): ['Start Company', 'Start CompanyID*', 'Start Company Index', 'Start Company Sector', 'Start Company Country', 'Start Company Type', 'Connected Company', 'Connected CompanyID*', 'Connected Company Index', 'Connected Company Sector', 'Connected Company Country', 'Connected Company Type', 'Director Name', 'DirectorID*', 'Connected Company Current/Historic', 'Connected Company Duration', 'Connected Company Role Name', 'ED/NED/Non-Brd', 'Connected Company Role Start Date', 'Connected Company Role End Date', 'Start Company Current/Historic', 'Start Company Duration', 'Start Company Role', 'Start ED/NED/Non-Brd', 'Start Company Role Start Date', 'Start Company Role End Date']
df.shape: (495419, 26)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (72685, 26)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Company Network - 9.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2019.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (11175, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (11175, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (2012, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2019.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 1999.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (3897, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (3897, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1167, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 1999.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2001.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (61, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (61, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (17, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2001.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - Current.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (93, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (93, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (29, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - Current.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2011.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (10727, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (10727, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1973, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2011.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2014.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (194, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (194, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (34, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2014.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2016.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (10989, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (10989, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (2088, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2016.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2021.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (85, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (85, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (12, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2021.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2007.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (13291, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (13291, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1813, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2007.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2013.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (10318, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (10318, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (2021, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2013.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2010.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (126, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (126, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (28, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2010.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2009.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (144, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (144, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (31, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2009.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2015.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (10822, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (10822, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (2078, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2015.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2000.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (5697, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (5697, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1427, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2000.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2012.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (10454, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (10454, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1985, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2012.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2007.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (160, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (160, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (37, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2007.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2003.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (99, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (99, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (22, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2003.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2018.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (11226, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (11226, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (2051, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2018.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2013.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (312, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (312, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (40, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2013.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2019.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (156, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (156, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (49, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2019.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2014.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (10595, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (10595, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (2024, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2014.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2020.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (29, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (29, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (10, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2020.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2020.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (7129, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (7129, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1471, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2020.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2021.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (0, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (0, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (0, 16)
Note: df has no rows and/or columns!
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2012.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (224, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (224, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (44, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2012.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2008.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (12632, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (12632, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1907, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2008.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2000.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (71, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (71, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (16, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2000.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2004.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (10069, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (10069, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1606, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2004.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2017.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (159, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (159, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (42, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2017.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2002.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (7221, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (7221, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1477, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2002.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2005.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (11954, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (11954, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1687, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2005.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2006.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (194, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (194, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (32, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2006.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 1999.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (32, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (32, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (2, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 1999.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2003.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (8351, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (8351, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1549, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2003.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2016.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (180, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (180, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (44, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2016.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2002.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (75, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (75, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (24, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2002.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2004.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (113, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (113, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (34, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2004.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2010.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (10855, 16)
---
Filtering df by columns:
---
/home/jasonjia/.local/lib/python3.8/site-packages/openpyxl/worksheet/_reader.py:329: UserWarning: Conditional Formatting extension is not supported and will be removed
  warn(msg)
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (10855, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1892, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2010.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2009.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (11454, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (11454, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1818, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2009.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Compensation - 2017.xlsx
Unique workbook name: Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (10885, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (10885, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (2064, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Compensation - 2017.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2011.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (211, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (211, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (32, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2011.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Compensation - 2005.xlsx
Unique workbook name: SMDEs Compensation
List of sheets to open: ['Summary']
------
Sheet 0 : Summary
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (146, 16)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker', 'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*', 'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked', 'Total Compensation', 'Total Wealth']
df.shape: (146, 16)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (37, 16)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Compensation - 2005.xlsx
Done!
-----------------------------------------------------------
List of files kept: ['UK - Company Network - 1.xlsx', 'UK - Company Network - 5.xlsx', 'UK - Company Network - 2.xlsx', 'UK - Company Network - 4.xlsx', 'UK - Company Network - 7.xlsx', 'UK - Company Network - 6.xlsx', 'UK - Company Network - 8.xlsx', 'UK - Company Network - 9.xlsx', 'UK - Compensation - 2019.xlsx', 'UK - Compensation - 1999.xlsx', 'UK - SMDEs Compensation - 2001.xlsx', 'UK - SMDEs Compensation - Current.xlsx', 'UK - Compensation - 2011.xlsx', 'UK - SMDEs Compensation - 2014.xlsx', 'UK - Compensation - 2016.xlsx', 'UK - Compensation - 2021.xlsx', 'UK - Compensation - 2007.xlsx', 'UK - Compensation - 2013.xlsx', 'UK - SMDEs Compensation - 2010.xlsx', 'UK - SMDEs Compensation - 2009.xlsx', 'UK - Compensation - 2015.xlsx', 'UK - Compensation - 2000.xlsx', 'UK - Compensation - 2012.xlsx', 'UK - SMDEs Compensation - 2007.xlsx', 'UK - SMDEs Compensation - 2003.xlsx', 'UK - Compensation - 2018.xlsx', 'UK - SMDEs Compensation - 2013.xlsx', 'UK - SMDEs Compensation - 2019.xlsx', 'UK - Compensation - 2014.xlsx', 'UK - SMDEs Compensation - 2020.xlsx', 'UK - Compensation - 2020.xlsx', 'UK - SMDEs Compensation - 2021.xlsx', 'UK - SMDEs Compensation - 2012.xlsx', 'UK - Compensation - 2008.xlsx', 'UK - SMDEs Compensation - 2000.xlsx', 'UK - Compensation - 2004.xlsx', 'UK - SMDEs Compensation - 2017.xlsx', 'UK - Compensation - 2002.xlsx', 'UK - Compensation - 2005.xlsx', 'UK - SMDEs Compensation - 2006.xlsx', 'UK - SMDEs Compensation - 1999.xlsx', 'UK - Compensation - 2003.xlsx', 'UK - SMDEs Compensation - 2016.xlsx', 'UK - SMDEs Compensation - 2002.xlsx', 'UK - SMDEs Compensation - 2004.xlsx', 'UK - Compensation - 2010.xlsx', 'UK - Compensation - 2009.xlsx', 'UK - Compensation - 2017.xlsx', 'UK - SMDEs Compensation - 2011.xlsx', 'UK - SMDEs Compensation - 2005.xlsx']
------
List of files not kept: []
Done!
