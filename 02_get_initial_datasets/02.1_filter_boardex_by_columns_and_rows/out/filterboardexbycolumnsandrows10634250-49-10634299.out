-----------------------------------------------------------
Output from Shell Script:
Job ID: 10634299
Job User: jasonjia
Num Cores: 1
Array(Task ID): 49 of 64
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: openpyxl in /home/jasonjia/.local/lib/python3.8/site-packages (3.1.2)
Requirement already satisfied: et-xmlfile in /home/jasonjia/.local/lib/python3.8/site-packages (from openpyxl) (1.1.0)

[notice] A new release of pip is available: 23.0.1 -> 23.1.2
[notice] To update, run: pip install --upgrade pip
Program Path: filter_boardex_by_columns_and_rows.py
Filepath of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_010523.xlsx
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Input Folder: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex
Output Folder: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows
-----------------------------------------------------------
Output from Python Script:
This is array 49 / 64
Filepath of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_010523.xlsx
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Input Folder (containing raw BoardEx .xlsx files): /project/kh_mercury_1/manager_and_board_characteristics/data/boardex
Output Folder (after we filter by both columns and rows): /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows
Total number of files in input folder: 3246
This process will cover file(s): 2401 to 2450
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 102.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497774, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497774, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (5743, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 102.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Director Network - 81.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499781, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499781, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (68069, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Director Network - 81.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 10.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499874, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499874, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (97981, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 10.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 127.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499141, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499141, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (18356, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 127.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Director Network - 92.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499357, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499357, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (71629, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Director Network - 92.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 150.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498787, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498787, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (22341, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 150.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 113.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497280, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497280, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (61054, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 113.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 169.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499772, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499772, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (19636, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 169.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 162.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497921, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497921, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (36146, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 162.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 128.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499309, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499309, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (5812, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 128.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 1.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498314, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498314, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (93248, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 1.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 119.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499814, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499814, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (17762, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 119.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 118.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498454, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498454, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (5967, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 118.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 107.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497116, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497116, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (42323, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 107.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Director Network - 90.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497259, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497259, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (49048, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Director Network - 90.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Director Network - 9.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497788, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497788, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (74682, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Director Network - 9.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Director Network - 98.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496520, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496520, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (63526, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Director Network - 98.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 160.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499756, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499756, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (53146, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 160.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 141.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499471, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499471, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (36744, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 141.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 114.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499757, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499757, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (30897, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 114.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 105.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496226, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496226, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (12612, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 105.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 100.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499760, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499760, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (7844, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 100.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 135.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499424, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499424, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (12629, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 135.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 13.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499556, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499556, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (96529, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 13.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Director Network - 85.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499594, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499594, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (84090, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Director Network - 85.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 12.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498579, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498579, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (99281, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 12.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 124.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (496440, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (496440, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (1796, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 124.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 147.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499702, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499702, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (30358, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 147.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Director Network - 99.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (11008, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (11008, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (4266, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Director Network - 99.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Director Network - 84.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499891, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499891, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (63164, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Director Network - 84.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 125.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498583, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498583, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (16206, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 125.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Director Network - 88.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (5804, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (5804, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (409, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Director Network - 88.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 138.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497431, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497431, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (47465, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 138.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 133.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499945, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499945, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (22109, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 133.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - Director Network - 95.xlsx
Unique workbook name: Director Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499602, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499602, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (64980, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - Director Network - 95.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 156.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499937, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499937, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (43117, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 156.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 166.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498648, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498648, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (7723, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 166.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 122.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499306, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499306, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (26689, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 122.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 146.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499999, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499999, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (21140, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 146.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 139.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498368, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498368, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (31804, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 139.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 136.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499423, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499423, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (51023, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 136.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 126.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (495959, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (495959, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (49387, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 126.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 157.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497378, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497378, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (67231, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 157.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 131.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (497737, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (497737, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (30817, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 131.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 130.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499995, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499995, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (30511, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 130.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 140.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499938, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (499938, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (70992, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 140.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 110.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (14763, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (14763, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (417, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 110.xlsx
Done!
-----------------------------------------------------------
File name (kept): UK - SMDEs Network - 16.xlsx
Unique workbook name: SMDEs Network
List of sheets to open: ['Director Network']
------
Sheet 0 : Director Network
% NaNs in first row: 95.5 > 30%, taking category = row 0 and variable name = row 1
df.shape: (498726, 22)
---
Filtering df by columns:
---
df.columns (after processing): Index(['DirectorID*', 'Last Name', 'First Name', 'Middle Name',
       'Connected Director Details - Linked DirectorID*',
       'Connected Director Details - Linked Last Name',
       'Connected Director Details - Linked First Name',
       'Connected Director Details - Linked Middle Name',
       'Connected Director Details - Connected CompanyID*',
       'Connected Director Details - Connected Company',
       'Connected Director Details - Index',
       'Connected Director Details - Sector',
       'Connected Director Details - Country',
       'Connected Director Details - Company Type',
       'Connected Director Details - Overlapping Person's Role',
       'Connected Director Details - Linked ED/NED/Non-Brd',
       'Connected Director Details - Individual's Role Title',
       'Connected Director Details - ED/NED/Non-Brd',
       'Connected Director Details - Start Overlap',
       'Connected Director Details - End Overlap',
       'Connected Director Details - Current/Historic',
       'Connected Director Details - Duration (Years)'],
      dtype='object')
List of cols to keep (after processing): ['DirectorID*', 'Last Name', 'First Name', 'Middle Name', 'Connected Director Details - Linked DirectorID*', 'Connected Director Details - Linked Last Name', 'Connected Director Details - Linked First Name', 'Connected Director Details - Linked Middle Name', 'Connected Director Details - Connected CompanyID*', 'Connected Director Details - Connected Company', 'Connected Director Details - Index', 'Connected Director Details - Sector', 'Connected Director Details - Country', 'Connected Director Details - Company Type', "Connected Director Details - Overlapping Person's Role", 'Connected Director Details - Linked ED/NED/Non-Brd', "Connected Director Details - Individual's Role Title", 'Connected Director Details - ED/NED/Non-Brd', 'Connected Director Details - Start Overlap', 'Connected Director Details - End Overlap', 'Connected Director Details - Current/Historic', 'Connected Director Details - Duration (Years)']
df.shape: (498726, 22)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (54943, 22)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/UK - SMDEs Network - 16.xlsx
Done!
-----------------------------------------------------------
File name (kept): Europe - SMDEs Profile - Employment Historical NonBoard - 2.xlsx
Unique workbook name: SMDEs Profile - Employment Historical NonBoard
List of sheets to open: ['Historic Non Board Role']
------
Sheet 0 : Historic Non Board Role
% NaNs in first row 0.0 <= 30%, taking header = row 0 as usual
df.shape: (14273, 15)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED/SM', 'Start Date',
       'End Date'],
      dtype='object')
List of cols to keep (after processing): ['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name', 'Company ISIN', 'Company Ticker', 'Company Index']
df.shape: (14273, 8)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (2695, 8)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/Europe - SMDEs Profile - Employment Historical NonBoard - 2.xlsx
Done!
-----------------------------------------------------------
File name (kept): Europe - SMDEs Org Summary - 1.xlsx
Unique workbook name: SMDEs Org Summary
List of sheets to open: ['Board Summary']
------
Sheet 0 : Board Summary
% NaNs in first row: 83.6 > 30%, taking category = row 0 and variable name = row 1
df.shape: (499939, 61)
---
Filtering df by columns:
---
df.columns (after processing): Index(['Annual Report Year', 'Country', 'CompanyID*', 'Company Name', 'ISIN',
       'Ticker', 'Index', 'Sector', 'Director Type', 'DirectorID*',
       'Individual Name', 'Characteristics of Roles - Individual Role',
       'Characteristics of Roles - Director Network Size',
       'Characteristics of Roles - Time to Retirement',
       'Characteristics of Roles - Time in Role',
       'Characteristics of Roles - Time on Board',
       'Characteristics of Roles - Time in Company',
       'Director Experience - Total Number of Quoted Boards to Date',
       'Director Experience - Total Number of Private Boards to Date',
       'Director Experience - Total Number of Other Boards to Date',
       'Director Experience - Total Number of Quoted Current Boards',
       'Director Experience - Total Number of Private Current Boards',
       'Director Experience - Total Number of Other Current Boards',
       'Director Experience - Avg. Yrs on Other Quoted Boards',
       'Director Experience - Age (Yrs)',
       'Director Experience - Number of Qualifications',
       'Director Experience - Gender', 'Director Experience - Nationality Mix',
       'Ratios - Bonus/ (Bonus&Salary)', 'Ratios - Equity Linked/ Total',
       'Ratios - Performance/ Total', 'Ratios - %Change from Last Period',
       'Ratios - Wealth Delta', 'Annual Direct Compensation - Salary',
       'Annual Direct Compensation - Bonus',
       'Annual Direct Compensation - D.C Pension',
       'Annual Direct Compensation - Other',
       'Annual Direct Compensation - Total Salary+Bonus',
       'Annual Direct Compensation - Total Inc. D.C. Pension & Other',
       'Annual- Equity Linked Options - Shares',
       'Annual- Equity Linked Options - LTIPS(max)',
       'Annual- Equity Linked Options - Vesting Date',
       'Annual- Equity Linked Options - Intrinsic Options (excercisable)',
       'Annual- Equity Linked Options - Intrinsic Options (unexercisable)',
       'Annual- Equity Linked Options - Estimated Options (exercisable)',
       'Annual- Equity Linked Options - Estimated Options (unexcercisable)',
       'Annual- Equity Linked Options - Share Price',
       'Annual- Equity Linked Options - Total Equity Linked Compensation',
       'Total - Total Annual Compensation', 'Accumulated Wealth - Shares',
       'Accumulated Wealth - LTIPS(max)',
       'Accumulated Wealth - Intrinsic Option',
       'Accumulated Wealth - Estimated Option',
       'Accumulated Wealth - Liquid Wealth', 'Total Wealth - Total Wealth',
       'Committee Members - AUDIT COMMITTEE MEMBER (if yes then put M)',
       'Committee Members - REMUNERATION/ COMPENSATION COMMITTEE MEMBER',
       'Committee Members - NOMINATION COMMITTEE MEMBER',
/home/jasonjia/.local/lib/python3.8/site-packages/openpyxl/worksheet/_reader.py:329: UserWarning: Conditional Formatting extension is not supported and will be removed
  warn(msg)
       'Committee Size - AUDIT COMMITTEE SIZE',
       'Committee Size - REMUNERATION/ COMPENSATION COMMITTEE SIZE',
       'Committee Size - NOMINATION COMMITTEE SIZE'],
      dtype='object')
List of cols to keep (after processing): ['Annual Report Year', 'Country', 'CompanyID*', 'Company Name', 'ISIN', 'Ticker', 'Index', 'Sector', 'Director Type', 'DirectorID*', 'Individual Name', 'Characteristics of Roles - Individual Role', 'Characteristics of Roles - Director Network Size', 'Characteristics of Roles - Time to Retirement', 'Characteristics of Roles - Time in Role', 'Characteristics of Roles - Time on Board', 'Characteristics of Roles - Time in Company', 'Director Experience - Total Number of Quoted Boards to Date', 'Director Experience - Total Number of Private Boards to Date', 'Director Experience - Total Number of Other Boards to Date', 'Director Experience - Total Number of Quoted Current Boards', 'Director Experience - Total Number of Private Current Boards', 'Director Experience - Total Number of Other Current Boards', 'Director Experience - Avg. Yrs on Other Quoted Boards', 'Director Experience - Age (Yrs)', 'Director Experience - Number of Qualifications', 'Director Experience - Gender', 'Director Experience - Nationality Mix', 'Ratios - Bonus/ (Bonus&Salary)', 'Ratios - Equity Linked/ Total', 'Ratios - Performance/ Total', 'Ratios - %Change from Last Period', 'Ratios - Wealth Delta', 'Annual Direct Compensation - Salary', 'Annual Direct Compensation - Bonus', 'Annual Direct Compensation - D.C Pension', 'Annual Direct Compensation - Other', 'Annual Direct Compensation - Total Salary+Bonus', 'Annual Direct Compensation - Total Inc. D.C. Pension & Other', 'Annual- Equity Linked Options - Shares', 'Annual- Equity Linked Options - LTIPS(max)', 'Annual- Equity Linked Options - Vesting Date', 'Annual- Equity Linked Options - Intrinsic Options (excercisable)', 'Annual- Equity Linked Options - Intrinsic Options (unexercisable)', 'Annual- Equity Linked Options - Estimated Options (exercisable)', 'Annual- Equity Linked Options - Estimated Options (unexcercisable)', 'Annual- Equity Linked Options - Share Price', 'Annual- Equity Linked Options - Total Equity Linked Compensation', 'Total - Total Annual Compensation', 'Accumulated Wealth - Shares', 'Accumulated Wealth - LTIPS(max)', 'Accumulated Wealth - Intrinsic Option', 'Accumulated Wealth - Estimated Option', 'Accumulated Wealth - Liquid Wealth', 'Total Wealth - Total Wealth']
df.shape: (499939, 55)
Done!
---
Filtering df by rows:
---
Found column that contains 'companyid', filtering by rows.
df.shape: (146815, 55)
df saved to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/02.1_boardex_filtered_by_columns_and_rows/Europe - SMDEs Org Summary - 1.xlsx
Done!
-----------------------------------------------------------
List of files kept: ['UK - SMDEs Network - 102.xlsx', 'UK - Director Network - 81.xlsx', 'UK - SMDEs Network - 10.xlsx', 'UK - SMDEs Network - 127.xlsx', 'UK - Director Network - 92.xlsx', 'UK - SMDEs Network - 150.xlsx', 'UK - SMDEs Network - 113.xlsx', 'UK - SMDEs Network - 169.xlsx', 'UK - SMDEs Network - 162.xlsx', 'UK - SMDEs Network - 128.xlsx', 'UK - SMDEs Network - 1.xlsx', 'UK - SMDEs Network - 119.xlsx', 'UK - SMDEs Network - 118.xlsx', 'UK - SMDEs Network - 107.xlsx', 'UK - Director Network - 90.xlsx', 'UK - Director Network - 9.xlsx', 'UK - Director Network - 98.xlsx', 'UK - SMDEs Network - 160.xlsx', 'UK - SMDEs Network - 141.xlsx', 'UK - SMDEs Network - 114.xlsx', 'UK - SMDEs Network - 105.xlsx', 'UK - SMDEs Network - 100.xlsx', 'UK - SMDEs Network - 135.xlsx', 'UK - SMDEs Network - 13.xlsx', 'UK - Director Network - 85.xlsx', 'UK - SMDEs Network - 12.xlsx', 'UK - SMDEs Network - 124.xlsx', 'UK - SMDEs Network - 147.xlsx', 'UK - Director Network - 99.xlsx', 'UK - Director Network - 84.xlsx', 'UK - SMDEs Network - 125.xlsx', 'UK - Director Network - 88.xlsx', 'UK - SMDEs Network - 138.xlsx', 'UK - SMDEs Network - 133.xlsx', 'UK - Director Network - 95.xlsx', 'UK - SMDEs Network - 156.xlsx', 'UK - SMDEs Network - 166.xlsx', 'UK - SMDEs Network - 122.xlsx', 'UK - SMDEs Network - 146.xlsx', 'UK - SMDEs Network - 139.xlsx', 'UK - SMDEs Network - 136.xlsx', 'UK - SMDEs Network - 126.xlsx', 'UK - SMDEs Network - 157.xlsx', 'UK - SMDEs Network - 131.xlsx', 'UK - SMDEs Network - 130.xlsx', 'UK - SMDEs Network - 140.xlsx', 'UK - SMDEs Network - 110.xlsx', 'UK - SMDEs Network - 16.xlsx', 'Europe - SMDEs Profile - Employment Historical NonBoard - 2.xlsx', 'Europe - SMDEs Org Summary - 1.xlsx']
------
List of files not kept: []
Done!
