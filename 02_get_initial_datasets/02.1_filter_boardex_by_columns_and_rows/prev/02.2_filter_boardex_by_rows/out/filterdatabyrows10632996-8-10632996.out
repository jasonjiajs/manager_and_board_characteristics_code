-------------------------------------------
Job ID: 10632996
Job User: jasonjia
Num Cores: 8
Array(Task ID): 8 of 8
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: openpyxl in /home/jasonjia/.local/lib/python3.8/site-packages (3.1.2)
Requirement already satisfied: et-xmlfile in /home/jasonjia/.local/lib/python3.8/site-packages (from openpyxl) (1.1.0)

[notice] A new release of pip is available: 23.0.1 -> 23.1.2
[notice] To update, run: pip install --upgrade pip
Program Path: filter_data_by_rows.py
Input Directory: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/europe_smallfiles
Output Directory: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
-------------------------------------------
This is array 8 / 8
Input Dir: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/europe_smallfiles
Output Dir: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Total number of files: 27
This process will cover file(s): 22 to 27
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/europe_smallfiles/Europe - Director Profile - Employment Historical Board.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED', 'Start Date',
       'End Date', 'Committee Name', 'Committee Role'],
      dtype='object')
Shape of filtered df: (58218, 17)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/Europe - Director Profile - Employment Historical Board_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/europe_smallfiles/Europe - SMDEs Profile - Education & Achievements.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Country', 'DirectorID*', 'Director Name', 'InstitutionID*',
       'Institution Name', 'Company Type', 'Qualification',
       'Qualification Description', 'Qualification Date'],
      dtype='object')
No column found that contains 'companyid', skipping df
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/europe_smallfiles/Europe - SMDEs Profile - Other Activities.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Role', 'Role Description', 'Start Date'],
      dtype='object')
No matching entries in this df, skipping df
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/europe_smallfiles/Europe - Director Profile - Employment Current Board.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED', 'Start Date',
       'Committee Name', 'Committee Role'],
      dtype='object')
Shape of filtered df: (11678, 16)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/Europe - Director Profile - Employment Current Board_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/europe_smallfiles/Europe - SMDEs Profile - Employment Historical NonBoard - 1.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED/SM', 'Start Date',
       'End Date'],
      dtype='object')
Shape of filtered df: (67868, 15)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/Europe - SMDEs Profile - Employment Historical NonBoard - 1_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/europe_smallfiles/Europe - Committee Details.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Annual Report Year', 'CompanyID*', 'Company Name', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'DirectorID*', 'Director Name',
       'Director Type (ED or SD)', 'Committee Name', 'Committee Role',
       'Functional Experience', 'Board Role', 'Board Position(Yes/No)',
       'Other Like Committees', 'Other Board Name', 'Director Role Status'],
      dtype='object')
Shape of filtered df: (915, 19)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/Europe - Committee Details_filtered.xlsx
-------------------------------------------
Done!
