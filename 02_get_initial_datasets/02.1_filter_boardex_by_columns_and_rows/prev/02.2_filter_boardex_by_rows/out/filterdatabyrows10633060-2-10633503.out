-------------------------------------------
Job ID: 10633503
Job User: jasonjia
Num Cores: 8
Array(Task ID): 2 of 8
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: openpyxl in /home/jasonjia/.local/lib/python3.8/site-packages (3.1.2)
Requirement already satisfied: et-xmlfile in /home/jasonjia/.local/lib/python3.8/site-packages (from openpyxl) (1.1.0)

[notice] A new release of pip is available: 23.0.1 -> 23.1.2
[notice] To update, run: pip install --upgrade pip
Program Path: filter_data_by_rows.py
Input Directory: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/uk_smallfiles
Output Directory: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
-------------------------------------------
This is array 2 / 8
Input Dir: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/uk_smallfiles
Output Dir: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Total number of files: 24
This process will cover file(s): 4 to 6
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/uk_smallfiles/UK - Company Details.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['CompanyID*', 'Company Name', 'HOAddress1', 'HOAddress2', 'HOAddress3',
       'HOAddress4', 'HOAddress5', 'HOCountryName', 'HO TelNumber',
       'HO FaxNumber', 'HO URL', 'CIK Code', 'ISIN', 'Ticker', 'Index',
       'Sector', 'Market Cap', 'Revenue at Year End ', 'Latest AR', 'Auditors',
       'Bankers'],
      dtype='object')
Shape of filtered df: (248, 21)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/UK - Company Details_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/uk_smallfiles/UK - Org Analysis Averages.xlsx
% NaNs in first row: 93.5 > 50%, taking category = row 0 and variable name = row 1
df.columns: Index(['Organisation Analysis & Averages - Company Name',
       'Organisation Analysis & Averages - CompanyID*',
       'Organisation Analysis & Averages - ISIN',
       'Organisation Analysis & Averages - Ticker',
       'Organisation Analysis & Averages - Index',
       'Organisation Analysis & Averages - Sector',
       'Organisation Analysis & Averages - Country',
       'Organisation Analysis & Averages - Report Year',
       'Organisation Analysis & Averages - Total Number of Board Members',
       'Organisation Analysis & Averages - Total Number of EDs',
       'Organisation Analysis & Averages - Total Number of NEDs',
       'Organisation Analysis & Averages - Independent SD Ratio',
       'Organisation Analysis & Averages - CEO and Chairman Roles are combined on the Board',
       'Organisation Analysis & Averages - Average Salary EDs',
       'Organisation Analysis & Averages - Average Salary NEDs',
       'Organisation Analysis & Averages - Average Bonus EDs',
       'Organisation Analysis & Averages - Average Bonus NEDs',
       'Organisation Analysis & Averages - Average Total Direct Compensation for EDs ',
       'Organisation Analysis & Averages - Average Total Direct Compensation for NEDs',
       'Organisation Analysis & Averages - Average Equity-Linked Shares for EDs',
       'Organisation Analysis & Averages - Average Equity-Linked Shares for NEDs',
       'Organisation Analysis & Averages - Average Equity-Linked LTIPs for EDs',
       'Organisation Analysis & Averages - Average Equity-Linked LTIPs for NEDs',
       'Organisation Analysis & Averages - Average Equity-Linked Shares under Options for EDs -intrinsic ',
       'Organisation Analysis & Averages - Average Equity-Linked Shares under Options for NEDs -intrinsic',
       'Organisation Analysis & Averages - Average Equity-Linked Shares under Options for EDs -estimated',
       'Organisation Analysis & Averages - Average Equity-Linked Shares under Options for NEDs -estimated',
       'Organisation Analysis & Averages - Average Total Equity-Linked Compensation for EDs ',
       'Organisation Analysis & Averages - Average Total Equity-Linked Compensation for NEDs',
       'Organisation Analysis & Averages - Average Wealth Shares EDs',
       'Organisation Analysis & Averages - ED Total Wealth Shares',
       'Organisation Analysis & Averages - Average Wealth Shares NEDs',
       'Organisation Analysis & Averages - NED Total Wealth Shares ',
       'Organisation Analysis & Averages - Average Wealth LTIPs EDs',
       'Organisation Analysis & Averages - ED Total Wealth LTIPS ',
       'Organisation Analysis & Averages - Average Wealth LTIPs NEDs',
       'Organisation Analysis & Averages - NED Total Wealth LTIPS',
       'Organisation Analysis & Averages - Average Wealth Shares under Options for EDs -intrinsic',
       'Organisation Analysis & Averages - ED Total Wealth Shares under Options  -intrinsic ',
       'Organisation Analysis & Averages - Average Wealth Shares under Options for NEDs -intrinsic',
       'Organisation Analysis & Averages - NED Total Wealth Shares under Options -intrinsic',
       'Organisation Analysis & Averages - Average Wealth Shares under Options for EDs -estimated',
       'Organisation Analysis & Averages - ED Total Wealth Shares under Options  - estimated',
       'Organisation Analysis & Averages - Average Wealth Shares under Options for NEDs - estimated',
       'Organisation Analysis & Averages - NED Total Wealth Shares under Options - estimated',
       'Organisation Analysis & Averages - Liquid Wealth ED Average',
       'Organisation Analysis & Averages - Liquid Wealth ED Total',
       'Organisation Analysis & Averages - Liquid Wealth NED Average',
       'Organisation Analysis & Averages - Liquid Wealth NED Total',
       'Organisation Analysis & Averages - Average time in role for EDs',
       'Organisation Analysis & Averages - Average time in role for NEDs',
       'Average Boards to Date ED's - Quoted',
       'Average Boards to Date ED's - Private',
       'Average Boards to Date ED's - Other',
       'Average Boards to Date NED's - Quoted',
       'Average Boards to Date NED's - Private',
       'Average Boards to Date NED's - Other',
       'Average Boards Currently ED's - Quoted',
       'Average Boards Currently ED's - Private',
       'Average Boards Currently ED's - Other',
       'Average Boards Currently NED's - Quoted',
       'Average Boards Currently NED's - Private',
       'Average Boards Currently NED's - Other',
       'Average Boards Currently NED's - Average years on Other Quoted Boards EDs',
       'Average Boards Currently NED's - Average years on Other Quoted Boards NEDs',
       'Average Boards Currently NED's - Average Age EDs',
       'Average Boards Currently NED's - Average Age NEDs',
       'Average Boards Currently NED's - Average Number of Education EDs',
       'Average Boards Currently NED's - Average Number of Education NED',
       'Average Boards Currently NED's - Gender (% Male) EDs',
       'Average Boards Currently NED's - Gender (% Male) NED',
       'Average Boards Currently NED's - Nationality Mix ED',
       'Average Boards Currently NED's - Nationality Mix NED',
       'Average Boards Currently NED's - Attrition (%) 1 Year ED',
       'Average Boards Currently NED's - Attrition (%) 1 Year NED',
       'Average Boards Currently NED's - Attrition (%) 3 Year ED',
       'Average Boards Currently NED's - Attrition (%) 3 Year NED'],
      dtype='object')
Shape of filtered df: (4405, 77)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/UK - Org Analysis Averages_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/uk_smallfiles/UK - SMDEs Profile - Employment Current Board.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED', 'Start Date',
       'Committee Name', 'Committee Role'],
      dtype='object')
Shape of filtered df: (2110, 16)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/UK - SMDEs Profile - Employment Current Board_filtered.xlsx
-------------------------------------------
Done!
