-------------------------------------------
Job ID: 10633106
Job User: jasonjia
Num Cores: 8
Array(Task ID): 1 of 8
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: openpyxl in /home/jasonjia/.local/lib/python3.8/site-packages (3.1.2)
Requirement already satisfied: et-xmlfile in /home/jasonjia/.local/lib/python3.8/site-packages (from openpyxl) (1.1.0)

[notice] A new release of pip is available: 23.0.1 -> 23.1.2
[notice] To update, run: pip install --upgrade pip
Program Path: filter_data_by_rows.py
Input Directory: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_smallfiles
Output Directory: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
-------------------------------------------
This is array 1 / 8
Input Dir: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_smallfiles
Output Dir: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Total number of files: 41
This process will cover file(s): 1 to 5
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_smallfiles/NA - Director Profile - Employment Historical Board - 1.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED', 'Start Date',
       'End Date', 'Committee Name', 'Committee Role'],
      dtype='object')
Shape of filtered df: (71429, 17)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/NA - Director Profile - Employment Historical Board - 1_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_smallfiles/NA - SMDEs Profile - Employment Historical NonBoard - 4.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED/SM', 'Start Date',
       'End Date'],
      dtype='object')
Shape of filtered df: (80922, 15)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/NA - SMDEs Profile - Employment Historical NonBoard - 4_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_smallfiles/NA - SMDEs Profile - Employment Historical NonBoard - 5.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED/SM', 'Start Date',
       'End Date'],
      dtype='object')
Shape of filtered df: (52463, 15)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/NA - SMDEs Profile - Employment Historical NonBoard - 5_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_smallfiles/NA - Org Analysis Averages.xlsx
% NaNs in first row: 93.5 > 50%, taking category = row 0 and variable name = row 1
df.columns: Index(['Organisation Analysis & Averages - Company Name',
       'Organisation Analysis & Averages - CompanyID*',
       'Organisation Analysis & Averages - ISIN',
       'Organisation Analysis & Averages - Ticker',
       'Organisation Analysis & Averages - Index',
       'Organisation Analysis & Averages - Sector',
       'Organisation Analysis & Averages - Country',
       'Organisation Analysis & Averages - Report Year',
       'Organisation Analysis & Averages - Total Number of Board Members',
       'Organisation Analysis & Averages - Total Number of EDs',
       'Organisation Analysis & Averages - Total Number of NEDs',
       'Organisation Analysis & Averages - Independent SD Ratio',
       'Organisation Analysis & Averages - CEO and Chairman Roles are combined on the Board',
       'Organisation Analysis & Averages - Average Salary EDs',
       'Organisation Analysis & Averages - Average Salary NEDs',
       'Organisation Analysis & Averages - Average Bonus EDs',
       'Organisation Analysis & Averages - Average Bonus NEDs',
       'Organisation Analysis & Averages - Average Total Direct Compensation for EDs ',
       'Organisation Analysis & Averages - Average Total Direct Compensation for NEDs',
       'Organisation Analysis & Averages - Average Equity-Linked Shares for EDs',
       'Organisation Analysis & Averages - Average Equity-Linked Shares for NEDs',
       'Organisation Analysis & Averages - Average Equity-Linked LTIPs for EDs',
       'Organisation Analysis & Averages - Average Equity-Linked LTIPs for NEDs',
       'Organisation Analysis & Averages - Average Equity-Linked Shares under Options for EDs -intrinsic ',
       'Organisation Analysis & Averages - Average Equity-Linked Shares under Options for NEDs -intrinsic',
       'Organisation Analysis & Averages - Average Equity-Linked Shares under Options for EDs -estimated',
       'Organisation Analysis & Averages - Average Equity-Linked Shares under Options for NEDs -estimated',
       'Organisation Analysis & Averages - Average Total Equity-Linked Compensation for EDs ',
       'Organisation Analysis & Averages - Average Total Equity-Linked Compensation for NEDs',
       'Organisation Analysis & Averages - Average Wealth Shares EDs',
       'Organisation Analysis & Averages - ED Total Wealth Shares',
       'Organisation Analysis & Averages - Average Wealth Shares NEDs',
       'Organisation Analysis & Averages - NED Total Wealth Shares ',
       'Organisation Analysis & Averages - Average Wealth LTIPs EDs',
       'Organisation Analysis & Averages - ED Total Wealth LTIPS ',
       'Organisation Analysis & Averages - Average Wealth LTIPs NEDs',
       'Organisation Analysis & Averages - NED Total Wealth LTIPS',
       'Organisation Analysis & Averages - Average Wealth Shares under Options for EDs -intrinsic',
       'Organisation Analysis & Averages - ED Total Wealth Shares under Options  -intrinsic ',
       'Organisation Analysis & Averages - Average Wealth Shares under Options for NEDs -intrinsic',
       'Organisation Analysis & Averages - NED Total Wealth Shares under Options -intrinsic',
       'Organisation Analysis & Averages - Average Wealth Shares under Options for EDs -estimated',
       'Organisation Analysis & Averages - ED Total Wealth Shares under Options  - estimated',
       'Organisation Analysis & Averages - Average Wealth Shares under Options for NEDs - estimated',
       'Organisation Analysis & Averages - NED Total Wealth Shares under Options - estimated',
       'Organisation Analysis & Averages - Liquid Wealth ED Average',
       'Organisation Analysis & Averages - Liquid Wealth ED Total',
       'Organisation Analysis & Averages - Liquid Wealth NED Average',
       'Organisation Analysis & Averages - Liquid Wealth NED Total',
       'Organisation Analysis & Averages - Average time in role for EDs',
       'Organisation Analysis & Averages - Average time in role for NEDs',
       'Average Boards to Date ED's - Quoted',
       'Average Boards to Date ED's - Private',
       'Average Boards to Date ED's - Other',
       'Average Boards to Date NED's - Quoted',
       'Average Boards to Date NED's - Private',
       'Average Boards to Date NED's - Other',
       'Average Boards Currently ED's - Quoted',
       'Average Boards Currently ED's - Private',
       'Average Boards Currently ED's - Other',
       'Average Boards Currently NED's - Quoted',
       'Average Boards Currently NED's - Private',
       'Average Boards Currently NED's - Other',
       'Average Boards Currently NED's - Average years on Other Quoted Boards EDs',
       'Average Boards Currently NED's - Average years on Other Quoted Boards NEDs',
       'Average Boards Currently NED's - Average Age EDs',
       'Average Boards Currently NED's - Average Age NEDs',
       'Average Boards Currently NED's - Average Number of Education EDs',
       'Average Boards Currently NED's - Average Number of Education NED',
       'Average Boards Currently NED's - Gender (% Male) EDs',
       'Average Boards Currently NED's - Gender (% Male) NED',
       'Average Boards Currently NED's - Nationality Mix ED',
       'Average Boards Currently NED's - Nationality Mix NED',
       'Average Boards Currently NED's - Attrition (%) 1 Year ED',
       'Average Boards Currently NED's - Attrition (%) 1 Year NED',
       'Average Boards Currently NED's - Attrition (%) 3 Year ED',
       'Average Boards Currently NED's - Attrition (%) 3 Year NED'],
      dtype='object')
Shape of filtered df: (29607, 77)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/NA - Org Analysis Averages_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_smallfiles/NA - SMDEs Mapping File.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Bex Dir ID', 'DirectorID*', 'Director Name'], dtype='object')
No column found that contains 'companyid', skipping df
-------------------------------------------
Done!
