-------------------------------------------
Job ID: 10633461
Job User: jasonjia
Num Cores: 8
Array(Task ID): 2 of 8
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: openpyxl in /home/jasonjia/.local/lib/python3.8/site-packages (3.1.2)
Requirement already satisfied: et-xmlfile in /home/jasonjia/.local/lib/python3.8/site-packages (from openpyxl) (1.1.0)

[notice] A new release of pip is available: 23.0.1 -> 23.1.2
[notice] To update, run: pip install --upgrade pip
Program Path: filter_data_by_rows.py
Input Directory: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/row_smallfiles
Output Directory: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
-------------------------------------------
This is array 2 / 8
Input Dir: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/row_smallfiles
Output Dir: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Total number of files: 29
This process will cover file(s): 4 to 6
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/row_smallfiles/ROW - Director Profile - Employment Current Board.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED', 'Start Date',
       'Committee Name', 'Committee Role'],
      dtype='object')
Shape of filtered df: (11921, 16)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/ROW - Director Profile - Employment Current Board_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/row_smallfiles/ROW - Board Summary - 1.xlsx
% NaNs in first row: 82.2 > 50%, taking category = row 0 and variable name = row 1
df.columns: Index(['Annual Report Year', 'Country', 'CompanyID*', 'Company Name', 'ISIN',
       'Ticker', 'Index', 'Sector', 'Director Type (ED or SD)', 'DirectorID*',
       'Individual Name', 'Characteristics of Roles - Individual Role',
       'Characteristics of Roles - Director Network Size',
       'Characteristics of Roles - Time to Retirement',
       'Characteristics of Roles - Time in Role',
       'Characteristics of Roles - Time on Board',
       'Characteristics of Roles - Time in Company',
       'Director Experience - Total Number of Quoted Boards to Date',
       'Director Experience - Total Number of Private Boards to Date',
       'Director Experience - Total Number of Other Boards to Date',
       'Director Experience - Total Number of Quoted Current Boards',
       'Director Experience - Total Number of Private Current Boards',
       'Director Experience - Total Number of Other Current Boards',
       'Director Experience - Avg. Yrs on Other Quoted Boards',
       'Director Experience - Age (Yrs)',
       'Director Experience - Number of Qualifications',
       'Director Experience - Gender', 'Director Experience - Nationality Mix',
       'Ratios - Bonus/ (Bonus&Salary)', 'Ratios - Equity Linked/ Total',
       'Ratios - Performance/ Total', 'Ratios - %Change from Last Period',
       'Ratios - Wealth Delta',
       'Director Count Totals - Total Directors on the Board',
       'Director Count Totals - Number of SDs on Board',
       'Director Count Totals - Number of Independent NED on Board',
       'Director Count Totals - Executive Chairman present on Board or Combined role of CEO & Chairman is present (1- Yes, 0 - No)',
       'Director Count Totals - Number of Independent NED with past CFO/FD role ',
       'Annual Direct Compensation  - Salary',
       'Annual Direct Compensation  - Bonus',
       'Annual Direct Compensation  - D.C Pension',
       'Annual Direct Compensation  - Other',
       'Annual Direct Compensation  - Total Salary+Bonus',
       'Annual Direct Compensation  - Total Inc. D.C. Pension & Other',
       'Annual- Equity Linked Options - Shares',
       'Annual- Equity Linked Options - LTIPS(max)',
       'Annual- Equity Linked Options - Vesting Date',
       'Annual- Equity Linked Options - Intrinsic Options (excercisable)',
       'Annual- Equity Linked Options - Intrinsic Options (unexercisable)',
       'Annual- Equity Linked Options - Estimated Options (exercisable)',
       'Annual- Equity Linked Options - Estimated Options (unexcercisable)',
       'Annual- Equity Linked Options - Share Price',
       'Annual- Equity Linked Options - Total Equity Linked Compensation ',
       'Total - Total Annual Compensation ', 'Accumulated Wealth - Shares',
       'Accumulated Wealth - LTIPS(max)',
       'Accumulated Wealth - Intrinsic Option',
       'Accumulated Wealth - Estimated Option',
       'Accumulated Wealth - Liquid Wealth', 'Total Wealth - Total Wealth',
       'Committee Members - AUDIT COMMITTEE MEMBER   (if yes then put M)',
       'Committee Members - REMUNERATION/ COMPENSATION COMMITTEE MEMBER',
       'Committee Members - NOMINATION COMMITTEE MEMBER',
       'Committee Size - AUDIT COMMITTEE SIZE',
       'Committee Size - REMUNERATION/ COMPENSATION COMMITTEE SIZE',
       'Committee Size - NOMINATION COMMITTEE SIZE',
       'Number of Independent NEDs in Committee - Number of Independent NED on Audit Committee',
       'Number of Independent NEDs in Committee - Number of Independent NED on Remuneration/ Compensation Committee',
       'Number of Independent NEDs in Committee - Number of Independent NED on Nomination Committee',
       'Independent NEDs excluding Chairman Independent NED - Number of Independent NED on Audit (excluding Chairman Independent NED)',
       'Independent NEDs excluding Chairman Independent NED - Number of Independent NED on Remuneration/ Compensation (excluding Chairman Independent NED)',
       'Independent NEDs excluding Chairman Independent NED - Number of Independent NED on Nomination (excluding Chairman Independent NED)',
       'Independent NEDs excluding Chairman Independent NED - Number of Independent NED with functional expertise on Audit Committee'],
      dtype='object')
Shape of filtered df: (63029, 73)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/ROW - Board Summary - 1_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/row_smallfiles/ROW - Director Profile - Employment Historical Board - 2.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Country', 'DirectorID*', 'Director Name', 'CompanyID*', 'Company Name',
       'Company ISIN', 'Company Ticker', 'Company Index', 'Sector Name',
       'Company Type', 'Role', 'Role Description', 'ED/NED', 'Start Date',
       'End Date', 'Committee Name', 'Committee Role'],
      dtype='object')
Shape of filtered df: (5083, 17)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/ROW - Director Profile - Employment Historical Board - 2_filtered.xlsx
-------------------------------------------
Done!
