-------------------------------------------
Job ID: 10633102
Job User: jasonjia
Num Cores: 8
Array(Task ID): 4 of 8
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: openpyxl in /home/jasonjia/.local/lib/python3.8/site-packages (3.1.2)
Requirement already satisfied: et-xmlfile in /home/jasonjia/.local/lib/python3.8/site-packages (from openpyxl) (1.1.0)

[notice] A new release of pip is available: 23.0.1 -> 23.1.2
[notice] To update, run: pip install --upgrade pip
Program Path: filter_data_by_rows.py
Input Directory: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_companynetwork
Output Directory: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
-------------------------------------------
This is array 4 / 8
Input Dir: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_companynetwork
Output Dir: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Total number of files: 46
This process will cover file(s): 16 to 20
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_companynetwork/NA - Company Network - 39.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Start Company', 'Start CompanyID*', 'Start Company Index',
       'Start Company Sector', 'Start Company Country', 'Start Company Type',
       'Connected Company', 'Connected CompanyID*', 'Connected Company Index',
       'Connected Company Sector', 'Connected Company Country',
       'Connected Company Type', 'Director Name', 'DirectorID*',
       'Connected Company Current/Historic', 'Connected Company Duration',
       'Connected Company Role Name', 'ED/NED/Non-Brd',
       'Connected Company Role Start Date', 'Connected Company Role End Date',
       'Start Company Current/Historic', 'Start Company Duration',
       'Start Company Role', 'Start ED/NED/Non-Brd',
       'Start Company Role Start Date', 'Start Company Role End Date'],
      dtype='object')
Shape of filtered df: (28729, 26)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/NA - Company Network - 39_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_companynetwork/NA - Company Network - 33.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Start Company', 'Start CompanyID*', 'Start Company Index',
       'Start Company Sector', 'Start Company Country', 'Start Company Type',
       'Connected Company', 'Connected CompanyID*', 'Connected Company Index',
       'Connected Company Sector', 'Connected Company Country',
       'Connected Company Type', 'Director Name', 'DirectorID*',
       'Connected Company Current/Historic', 'Connected Company Duration',
       'Connected Company Role Name', 'ED/NED/Non-Brd',
       'Connected Company Role Start Date', 'Connected Company Role End Date',
       'Start Company Current/Historic', 'Start Company Duration',
       'Start Company Role', 'Start ED/NED/Non-Brd',
       'Start Company Role Start Date', 'Start Company Role End Date'],
      dtype='object')
Shape of filtered df: (6029, 26)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/NA - Company Network - 33_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_companynetwork/NA - Company Network - 20.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Start Company', 'Start CompanyID*', 'Start Company Index',
       'Start Company Sector', 'Start Company Country', 'Start Company Type',
       'Connected Company', 'Connected CompanyID*', 'Connected Company Index',
       'Connected Company Sector', 'Connected Company Country',
       'Connected Company Type', 'Director Name', 'DirectorID*',
       'Connected Company Current/Historic', 'Connected Company Duration',
       'Connected Company Role Name', 'ED/NED/Non-Brd',
       'Connected Company Role Start Date', 'Connected Company Role End Date',
       'Start Company Current/Historic', 'Start Company Duration',
       'Start Company Role', 'Start ED/NED/Non-Brd',
       'Start Company Role Start Date', 'Start Company Role End Date'],
      dtype='object')
Shape of filtered df: (212801, 26)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/NA - Company Network - 20_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_companynetwork/NA - Company Network - 29.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Start Company', 'Start CompanyID*', 'Start Company Index',
       'Start Company Sector', 'Start Company Country', 'Start Company Type',
       'Connected Company', 'Connected CompanyID*', 'Connected Company Index',
       'Connected Company Sector', 'Connected Company Country',
       'Connected Company Type', 'Director Name', 'DirectorID*',
       'Connected Company Current/Historic', 'Connected Company Duration',
       'Connected Company Role Name', 'ED/NED/Non-Brd',
       'Connected Company Role Start Date', 'Connected Company Role End Date',
       'Start Company Current/Historic', 'Start Company Duration',
       'Start Company Role', 'Start ED/NED/Non-Brd',
       'Start Company Role Start Date', 'Start Company Role End Date'],
      dtype='object')
Shape of filtered df: (46714, 26)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/NA - Company Network - 29_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/na_companynetwork/NA - Company Network - 27.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Start Company', 'Start CompanyID*', 'Start Company Index',
       'Start Company Sector', 'Start Company Country', 'Start Company Type',
       'Connected Company', 'Connected CompanyID*', 'Connected Company Index',
       'Connected Company Sector', 'Connected Company Country',
       'Connected Company Type', 'Director Name', 'DirectorID*',
       'Connected Company Current/Historic', 'Connected Company Duration',
       'Connected Company Role Name', 'ED/NED/Non-Brd',
       'Connected Company Role Start Date', 'Connected Company Role End Date',
       'Start Company Current/Historic', 'Start Company Duration',
       'Start Company Role', 'Start ED/NED/Non-Brd',
       'Start Company Role Start Date', 'Start Company Role End Date'],
      dtype='object')
Shape of filtered df: (51877, 26)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/NA - Company Network - 27_filtered.xlsx
-------------------------------------------
Done!
