-------------------------------------------
Job ID: 10633438
Job User: jasonjia
Num Cores: 8
Array(Task ID): 2 of 8
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: openpyxl in /home/jasonjia/.local/lib/python3.8/site-packages (3.1.2)
Requirement already satisfied: et-xmlfile in /home/jasonjia/.local/lib/python3.8/site-packages (from openpyxl) (1.1.0)

[notice] A new release of pip is available: 23.0.1 -> 23.1.2
[notice] To update, run: pip install --upgrade pip
Program Path: filter_data_by_rows.py
Input Directory: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/row_compensation
Output Directory: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
-------------------------------------------
This is array 2 / 8
Input Dir: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/row_compensation
Output Dir: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows
Filepath to list of company IDs we want to filter by: /project/kh_mercury_1/manager_and_board_characteristics/output/01_convert_isins_and_gvkeys_to_boardex_companyids/companyids_to_search_for/companyids_to_search_for.xlsx
Total number of files: 48
This process will cover file(s): 7 to 12
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/row_compensation/ROW - Compensation - 2004.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
Shape of filtered df: (84, 16)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/ROW - Compensation - 2004_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/row_compensation/ROW - SMDEs Compensation - 2013.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
Shape of filtered df: (33, 16)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/ROW - SMDEs Compensation - 2013_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/row_compensation/ROW - SMDEs Compensation - 2016.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
Shape of filtered df: (19, 16)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/ROW - SMDEs Compensation - 2016_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/row_compensation/ROW - Compensation - 2012.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
Shape of filtered df: (155, 16)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/ROW - Compensation - 2012_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/row_compensation/ROW - SMDEs Compensation - 2005.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
Shape of filtered df: (22, 16)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/ROW - SMDEs Compensation - 2005_filtered.xlsx
-------------------------------------------
Filepath: /project/kh_mercury_1/manager_and_board_characteristics/data/boardex/row_compensation/ROW - SMDEs Compensation - 2009.xlsx
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns: Index(['Annual Report Year', 'Company Name', 'CompanyID*', 'ISIN', 'Ticker',
       'Index', 'Sector', 'Country', 'Director Name', 'DirectorID*',
       'Director Role', 'ED/SD', 'Direct Compensation', 'Equity Linked',
       'Total Compensation', 'Total Wealth'],
      dtype='object')
Shape of filtered df: (16, 16)
Saved filtered df to: /project/kh_mercury_1/manager_and_board_characteristics/output/02_get_initial_datasets/output_filtered_by_rows/ROW - SMDEs Compensation - 2009_filtered.xlsx
-------------------------------------------
Done!
