-----------------------------------------------------------
Output from Shell Script:
Job ID: 8828816
Job User: jasonjia
Num Cores: 1
Array(Task ID): 1 of 1
Program Path: filter_output_by_columns.py
File path of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/boardex/data/boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_230322.xlsx
Input Folder: /project/kh_mercury_1/boardex/data/uk_smallfiles
Output Folder: /project/kh_mercury_1/boardex/data/output_filtered_by_columns
Get only 'Characteristics' and 'EducationandAchievements': 1
-----------------------------------------------------------
Output from Python Script:
This is array 1 / 1
File path of .xslx containing list of columns in Boardex and ExecuComp: /project/kh_mercury_1/boardex/data/boardex_colstokeep/List_of_Variables_for_Boardex_and_Execucomp_230322.xlsx
Input Folder (containing .xlsx filtered by isins): /project/kh_mercury_1/boardex/data/uk_smallfiles
Output Folder (after we further filter by columns): /project/kh_mercury_1/boardex/data/output_filtered_by_columns
Get only 'Characteristics' and 'EducationandAchievements': 1
Total number of files in input folder: 24
This process will cover file(s): 1 to 24
-----------------------------------------------------------
File name (kept): UK - SMDEs Profile - Characteristics.xlsx
Unique workbook name: SMDEs Profile - Characteristics
List of sheets to open: ['Charcteristics']
------
Sheet 0 : Charcteristics
% NaNs in first row: 73.3 > 50%, taking header = row 1 by skipping row 0
df.columns (before processing): Index(['Director Name', 'DirectorID*', 'Age', 'DOB', 'DOD', 'Gender',
       'Nationality', 'Unnamed: 7', 'Quoted', 'Private', 'Other', 'Quoted.1',
       'Private.1', 'Other.1', 'Unnamed: 14'],
      dtype='object')
df.columns (after processing): Index(['Director Name', 'DirectorID*', 'Age', 'DOB', 'DOD', 'Gender',
       'Nationality', 'Unnamed: 7', 'Quoted', 'Private', 'Other', 'Quoted.1',
       'Private.1', 'Other.1', 'Unnamed: 14'],
      dtype='object')
List of cols to keep (before processing): ['DirectorID*', 'DOB']
List of cols to keep (after processing): ['DirectorID*', 'DOB']
df saved to: /project/kh_mercury_1/boardex/data/output_filtered_by_columns/UK - SMDEs Profile - Characteristics_cols.xlsx
-----------------------------------------------------------
File name (kept): UK - Director Profile - Education & Achievements.xlsx
Unique workbook name: Director Profile - Education & Achievements
List of sheets to open: ['Education', 'Achievements']
------
Sheet 0 : Education
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns (before processing): Index(['Country', 'DirectorID*', 'Director Name', 'InstitutionID*',
       'Institution Name', 'Company Type', 'Qualification',
       'Qualification Description', 'Qualification Date'],
      dtype='object')
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'InstitutionID*',
       'Institution Name', 'Company Type', 'Qualification',
       'Qualification Description', 'Qualification Date'],
      dtype='object')
List of cols to keep (before processing): ['DirectorID*', 'Director Name', 'InstitutionID*', 'Institution Name', 'Company Type', 'Qualification', 'Qualification Description', 'Qualification Date']
List of cols to keep (after processing): ['DirectorID*', 'Director Name', 'InstitutionID*', 'Institution Name', 'Company Type', 'Qualification', 'Qualification Description', 'Qualification Date']
df saved to: /project/kh_mercury_1/boardex/data/output_filtered_by_columns/UK - Director Profile - Education & Achievements_sheet0_cols.xlsx
------
Sheet 1 : Achievements
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns (before processing): Index(['Country', 'DirectorID*', 'Director Name', 'OrganisationID*',
       'OrganisationName', 'Achievement Date', 'Award/Achievement'],
      dtype='object')
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'OrganisationID*',
       'OrganisationName', 'Achievement Date', 'Award/Achievement'],
      dtype='object')
List of cols to keep (before processing): ['Country', 'DirectorID*', 'Director Name', 'OrganisationID*', 'OrganisationName', 'Achievement Date', 'Award/Achievement']
List of cols to keep (after processing): ['Country', 'DirectorID*', 'Director Name', 'OrganisationID*', 'OrganisationName', 'Achievement Date', 'Award/Achievement']
df saved to: /project/kh_mercury_1/boardex/data/output_filtered_by_columns/UK - Director Profile - Education & Achievements_sheet1_cols.xlsx
-----------------------------------------------------------
File name (kept): UK - SMDEs Profile - Education & Achievements.xlsx
/home/jasonjia/standard_env_jason/lib/python3.6/site-packages/openpyxl/worksheet/_reader.py:312: UserWarning: Conditional Formatting extension is not supported and will be removed
  warn(msg)
Unique workbook name: SMDEs Profile - Education & Achievements
List of sheets to open: ['Education', 'Achievements']
------
Sheet 0 : Education
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns (before processing): Index(['Country', 'DirectorID*', 'Director Name', 'InstitutionID*',
       'Institution Name', 'Company Type', 'Qualification',
       'Qualification Description', 'Qualification Date'],
      dtype='object')
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'InstitutionID*',
       'Institution Name', 'Company Type', 'Qualification',
       'Qualification Description', 'Qualification Date'],
      dtype='object')
List of cols to keep (before processing): ['DirectorID*', 'Director Name', 'InstitutionID*', 'Institution Name', 'Company Type', 'Qualification', 'Qualification Description', 'Qualification Date']
List of cols to keep (after processing): ['DirectorID*', 'Director Name', 'InstitutionID*', 'Institution Name', 'Company Type', 'Qualification', 'Qualification Description', 'Qualification Date']
df saved to: /project/kh_mercury_1/boardex/data/output_filtered_by_columns/UK - SMDEs Profile - Education & Achievements_sheet0_cols.xlsx
------
Sheet 1 : Achievements
% NaNs in first row 0.0 <= 50%, taking header = row 0 as usual
df.columns (before processing): Index(['Country', 'DirectorID*', 'Director Name', 'OrganisationID*',
       'OrganisationName', 'Achievement Date', 'Award/Achievement'],
      dtype='object')
df.columns (after processing): Index(['Country', 'DirectorID*', 'Director Name', 'OrganisationID*',
       'OrganisationName', 'Achievement Date', 'Award/Achievement'],
      dtype='object')
List of cols to keep (before processing): ['Country', 'DirectorID*', 'Director Name', 'OrganisationID*', 'OrganisationName', 'Achievement Date', 'Award/Achievement']
List of cols to keep (after processing): ['Country', 'DirectorID*', 'Director Name', 'OrganisationID*', 'OrganisationName', 'Achievement Date', 'Award/Achievement']
df saved to: /project/kh_mercury_1/boardex/data/output_filtered_by_columns/UK - SMDEs Profile - Education & Achievements_sheet1_cols.xlsx
-----------------------------------------------------------
File name (kept): UK - Director Profile - Characteristics.xlsx
Unique workbook name: Director Profile - Characteristics
List of sheets to open: ['Charcteristics']
------
Sheet 0 : Charcteristics
% NaNs in first row: 73.3 > 50%, taking header = row 1 by skipping row 0
df.columns (before processing): Index(['Director Name', 'DirectorID*', 'Age', 'DOB', 'DOD', 'Gender',
       'Nationality', 'Unnamed: 7', 'Quoted', 'Private', 'Other', 'Quoted.1',
       'Private.1', 'Other.1', 'Unnamed: 14'],
      dtype='object')
df.columns (after processing): Index(['Director Name', 'DirectorID*', 'Age', 'DOB', 'DOD', 'Gender',
       'Nationality', 'Unnamed: 7', 'Quoted', 'Private', 'Other', 'Quoted.1',
       'Private.1', 'Other.1', 'Unnamed: 14'],
      dtype='object')
List of cols to keep (before processing): ['DirectorID*', 'DOB']
List of cols to keep (after processing): ['DirectorID*', 'DOB']
df saved to: /project/kh_mercury_1/boardex/data/output_filtered_by_columns/UK - Director Profile - Characteristics_cols.xlsx
-----------------------------------------------------------
List of files kept: ['UK - SMDEs Profile - Characteristics.xlsx', 'UK - Director Profile - Education & Achievements.xlsx', 'UK - SMDEs Profile - Education & Achievements.xlsx', 'UK - Director Profile - Characteristics.xlsx']
------
List of files not kept: ['UK - Director Profile - Employment Current NonBoard.xlsx', 'UK - SMDEs Profile - Employment Current NonBoard.xlsx', 'UK - Company Details.xlsx', 'UK - Org Analysis Averages.xlsx', 'UK - SMDEs Profile - Employment Current Board.xlsx', 'UK - Director Profile - Other Activities.xlsx', 'UK - SMDEs Org Summary.xlsx', 'UK - Director Details Mapping File.xlsx', 'UK - SMDEs Committee Details.xlsx', 'UK - Director Profile - Employment Historical Board.xlsx', 'UK - SMDEs Company Announcements.xlsx', 'UK - SMDEs Profile - Employment Historical Board.xlsx', 'UK - Committee Details.xlsx', 'UK - SMDEs Profile - Other Activities.xlsx', 'UK - SMDEs Profile - Employment Historical NonBoard.xlsx', 'UK - SMDEs Mapping File.xlsx', 'UK - Board Summary.xlsx', 'UK - Director Profile - Employment Historical NonBoard.xlsx', 'UK - Company Announcements.xlsx', 'UK - Director Profile - Employment Current Board.xlsx']
Done!
